<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Z.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="tango_subtle.css" type="text/css" />
<link rel="stylesheet" href="tango_subtle.min.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.13.0+0.13.0. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> Basics Types.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> Algebra.Groups.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> Algebra.AbGroups.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> Algebra.Rings.CRing.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> Spaces.Int Spaces.Pos.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> WildCat.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** In this file we define the ring Z of integers. The underlying abelian group is already defined in Algebra.AbGroups.Z. Many of the ring axioms are proven and made opaque. Typically, everything inside IsRing can be opaque since we will only ever rewrite along them and they are hprops. This also means we don&#39;t have to be too careful with how our proofs are structured. This allows us to freely use tactics such as rewrite. It would perhaps be possible to shorten many of the proofs here, but it would probably be unneeded due to the opacicty. *)</span>

<span class="sd">(** The ring of integers *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk0"><span class="highlight"><span class="kn">Definition</span> <span class="nf">cring_Z</span> : CRing.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">CRing</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">CRing</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk2"><span class="highlight">snrapply (Build_CRing abgroup_Z int_add int_mul <span class="mi">0</span>%int <span class="mi">1</span>%int); <span class="kp">only</span> <span class="mi">2</span>: <span class="kp">repeat</span> <span class="nb">split</span>; <span class="kp">try</span> <span class="bp">exact</span> _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Associative sg_op</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LeftIdentity sg_op mon_unit</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">RightIdentity sg_op mon_unit</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Commutative sg_op</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LeftDistribute mult plus</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk7"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Associative sg_op</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> int_mul_assoc.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk8"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LeftIdentity sg_op mon_unit</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> int_mul_1_l.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk9"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">RightIdentity sg_op mon_unit</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> int_mul_1_r.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chka"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Commutative sg_op</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> int_mul_comm.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkb"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LeftDistribute mult plus</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> int_mul_add_distr_l.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Local Open Scope</span> mc_scope.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** Multiplication of a ring element by an integer. *)</span>
<span class="sd">(** We call this a &quot;catamorphism&quot; which is the name of the map from an initial object. It seems to be a more common terminology in computer science. *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">cring_catamorphism_fun</span> (<span class="nv">R</span> : CRing) (<span class="nv">z</span> : cring_Z) : R
  := <span class="kr">match</span> z <span class="kr">with</span>
     | neg z =&gt; pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">nr</span> =&gt; -<span class="mi">1</span> + nr) z
     | <span class="mi">0</span>%int =&gt; <span class="mi">0</span>
     | pos z =&gt; pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">nr</span> =&gt; <span class="mi">1</span> + nr) z
     <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** TODO: remove these (they will be cleaned up in the future)*)</span>
<span class="sd">(** Left multiplication is an equivalence *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkc"><span class="highlight"><span class="kn">Instance</span> <span class="nf">isequiv_group_left_op</span> {<span class="nv">G</span>} `{IsGroup G}
  : <span class="kr">forall</span> (<span class="nv">x</span> : G), IsEquiv (<span class="kr">fun</span> <span class="nv">t</span> =&gt; sg_op x t).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : G, IsEquiv (<span class="kr">fun</span> <span class="nv">t</span> : G =&gt; sg_op x t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkd"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : G, IsEquiv (<span class="kr">fun</span> <span class="nv">t</span> : G =&gt; sg_op x t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chke"><span class="highlight"><span class="nb">intro</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (<span class="kr">fun</span> <span class="nv">t</span> : G =&gt; sg_op x t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkf"><span class="highlight">srapply isequiv_adjointify.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">G -&gt; G</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk10" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk10"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">t</span> : G =&gt; sg_op x t) o <span class="nl">?g</span> == idmap</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk11" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk11"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="nl">?g</span> o (<span class="kr">fun</span> <span class="nv">t</span> : G =&gt; sg_op x t) == idmap</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk12"><span class="highlight"><span class="mi">1</span>: <span class="bp">exact</span> (sg_op (-x)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">t</span> : G =&gt; sg_op x t) o sg_op (- x) == idmap</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk13" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk13"><hr></label><div class="goal-conclusion"><span class="highlight">sg_op (- x) o (<span class="kr">fun</span> <span class="nv">t</span> : G =&gt; sg_op x t) == idmap</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk14"><span class="highlight"><span class="kp">all</span>: <span class="nb">intro</span> y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op x (sg_op (- x) y) = y</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk15" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk15"><hr></label><div class="goal-conclusion"><span class="highlight">sg_op (- x) (sg_op x y) = y</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk16"><span class="highlight"><span class="kp">all</span>: <span class="nb">refine</span> (associativity _ _ _ @ _ @ left_identity y).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op (sg_op x (- x)) y = sg_op mon_unit y</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk17" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk17"><hr></label><div class="goal-conclusion"><span class="highlight">sg_op (sg_op (- x) x) y = sg_op mon_unit y</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk18"><span class="highlight"><span class="kp">all</span>: <span class="nb">refine</span> (ap (<span class="kr">fun</span> <span class="nv">x</span> =&gt; x * y) _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op x (- x) = mon_unit</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk19" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk19"><hr></label><div class="goal-conclusion"><span class="highlight">sg_op (- x) x = mon_unit</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk1a"><span class="highlight"><span class="mi">1</span>: <span class="nb">apply</span> right_inverse.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op (- x) x = mon_unit</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> left_inverse.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** Right multiplication is an equivalence *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk1b"><span class="highlight"><span class="kn">Instance</span> <span class="nf">isequiv_group_right_op</span> {<span class="nv">G</span>} `{IsGroup G}
  : <span class="kr">forall</span> <span class="nv">x</span>:G, IsEquiv (<span class="kr">fun</span> <span class="nv">y</span> =&gt; sg_op y x).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : G, IsEquiv (<span class="kr">fun</span> <span class="nv">y</span> : G =&gt; sg_op y x)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk1c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : G, IsEquiv (<span class="kr">fun</span> <span class="nv">y</span> : G =&gt; sg_op y x)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk1d"><span class="highlight"><span class="nb">intro</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (<span class="kr">fun</span> <span class="nv">y</span> : G =&gt; sg_op y x)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk1e"><span class="highlight">srapply isequiv_adjointify.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">G -&gt; G</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk1f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk1f"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">y</span> : G =&gt; sg_op y x) o <span class="nl">?g</span> == idmap</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk20" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk20"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="nl">?g</span> o (<span class="kr">fun</span> <span class="nv">y</span> : G =&gt; sg_op y x) == idmap</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk21"><span class="highlight"><span class="mi">1</span>: <span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">y</span> =&gt; sg_op y (- x)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">y</span> : G =&gt; sg_op y x)
o (<span class="kr">fun</span> <span class="nv">y</span> : G =&gt; sg_op y (- x)) == idmap</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk22" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk22"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">y</span> : G =&gt; sg_op y (- x))
o (<span class="kr">fun</span> <span class="nv">y</span> : G =&gt; sg_op y x) == idmap</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk23"><span class="highlight"><span class="kp">all</span>: <span class="nb">intro</span> y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op (sg_op y (- x)) x = y</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk24" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk24"><hr></label><div class="goal-conclusion"><span class="highlight">sg_op (sg_op y x) (- x) = y</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk25"><span class="highlight"><span class="kp">all</span>: <span class="nb">refine</span> ((associativity _ _ _)^ @ _ @ right_identity y).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op y (sg_op (- x) x) = sg_op y mon_unit</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk26" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk26"><hr></label><div class="goal-conclusion"><span class="highlight">sg_op y (sg_op x (- x)) = sg_op y mon_unit</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk27"><span class="highlight"><span class="kp">all</span>: <span class="nb">refine</span> (ap (y *.) _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op (- x) x = mon_unit</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk28" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk28"><hr></label><div class="goal-conclusion"><span class="highlight">sg_op x (- x) = mon_unit</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk29"><span class="highlight"><span class="mi">1</span>: <span class="nb">apply</span> left_inverse.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">G</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">SgOp G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Aunit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">MonUnit G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Anegate</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Negate G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsGroup G</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">G</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op x (- x) = mon_unit</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> right_inverse.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** Preservation of + *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk2a"><span class="highlight"><span class="kn">Instance</span> <span class="nf">issemigrouppreserving_cring_catamorphism_fun_plus</span> (<span class="nv">R</span> : CRing)
  : IsSemiGroupPreserving (Aop:=cring_plus) (Bop:=cring_plus)
      (cring_catamorphism_fun R : cring_Z -&gt; R).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsSemiGroupPreserving
  (cring_catamorphism_fun R : cring_Z -&gt; R)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk2b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsSemiGroupPreserving
  (cring_catamorphism_fun R : cring_Z -&gt; R)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  <span class="sd">(** Unfortunately, due to how we have defined things we need to seperate this out into 9 cases. *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk2c"><span class="highlight"><span class="nb">hnf</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : cring_Z,
cring_catamorphism_fun R (sg_op x y) =
sg_op (cring_catamorphism_fun R x)
  (cring_catamorphism_fun R y)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk2d"><span class="highlight"><span class="nb">intros</span> [x| |x] [y| |y].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (neg y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk2e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk2e"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) <span class="mi">0</span>%int) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R <span class="mi">0</span>%int)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk2f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk2f"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (pos y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk30" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk30"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op <span class="mi">0</span>%int (neg y)) =
sg_op (cring_catamorphism_fun R <span class="mi">0</span>%int)
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk31" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk31"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op <span class="mi">0</span>%int <span class="mi">0</span>%int) =
sg_op (cring_catamorphism_fun R <span class="mi">0</span>%int)
  (cring_catamorphism_fun R <span class="mi">0</span>%int)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk32" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk32"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op <span class="mi">0</span>%int (pos y)) =
sg_op (cring_catamorphism_fun R <span class="mi">0</span>%int)
  (cring_catamorphism_fun R (pos y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk33" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk33"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (neg y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk34" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk34"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) <span class="mi">0</span>%int) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R <span class="mi">0</span>%int)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk35" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk35"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (pos y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  <span class="sd">(** Some of these cases are easy however *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk36"><span class="highlight"><span class="mi">2</span>,<span class="mi">5</span>,<span class="mi">8</span>: <span class="nb">cbn</span>; <span class="bp">by</span> <span class="nb">rewrite</span> right_identity.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (neg y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk37" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk37"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (pos y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk38" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk38"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op <span class="mi">0</span>%int (neg y)) =
sg_op (cring_catamorphism_fun R <span class="mi">0</span>%int)
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk39" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk39"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op <span class="mi">0</span>%int (pos y)) =
sg_op (cring_catamorphism_fun R <span class="mi">0</span>%int)
  (cring_catamorphism_fun R (pos y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk3a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk3a"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (neg y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk3b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk3b"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (pos y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk3c"><span class="highlight"><span class="mi">3</span>,<span class="mi">4</span>: <span class="nb">symmetry</span>; <span class="nb">apply</span> left_identity.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (neg y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk3d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk3d"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (pos y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk3e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk3e"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (neg y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk3f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk3f"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (pos y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  <span class="sd">(** This leaves us with four cases to consider *)</span>
  <span class="sd">(** x &lt; 0 , y &lt; 0 *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk40"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (neg y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk41"><span class="highlight"><span class="nb">change</span> (cring_catamorphism_fun R ((neg x) + (neg y))%int
      = (cring_catamorphism_fun R (neg x)) + (cring_catamorphism_fun R (neg y))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (neg x + neg y)%int =
cring_catamorphism_fun R (neg x) +
cring_catamorphism_fun R (neg y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk42"><span class="highlight"><span class="nb">induction</span> y <span class="kr">as</span> [|y IHy] <span class="nb">using</span> pos_peano_ind.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (neg x + -<span class="mi">1</span>)%int =
cring_catamorphism_fun R (neg x) +
cring_catamorphism_fun R (-<span class="mi">1</span>)%int</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk43" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (neg x + neg y)%int =
cring_catamorphism_fun R (neg x) + cring_catamorphism_fun R (neg y)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk43"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (neg x + neg (pos_succ y))%int =
cring_catamorphism_fun R (neg x) +
cring_catamorphism_fun R (neg (pos_succ y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk44"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (neg x + -<span class="mi">1</span>)%int =
cring_catamorphism_fun R (neg x) +
cring_catamorphism_fun R (-<span class="mi">1</span>)%int</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk45"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (x + <span class="mi">1</span>)%pos =
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk46"><span class="highlight"><span class="nb">rewrite</span> pos_add_1_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ x) =
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk47"><span class="highlight"><span class="nb">rewrite</span> pos_peano_rec_beta_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">-<span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x =
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> commutativity.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk48"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (neg x + neg y)%int =
cring_catamorphism_fun R (neg x) + cring_catamorphism_fun R (neg y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (neg x + neg (pos_succ y))%int =
cring_catamorphism_fun R (neg x) +
cring_catamorphism_fun R (neg (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk49"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (neg x + neg y)%int =
cring_catamorphism_fun R (neg x) + cring_catamorphism_fun R (neg y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr)
  (x + pos_succ y)%pos =
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk4a"><span class="highlight"><span class="nb">rewrite</span> pos_add_succ_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (neg x + neg y)%int =
cring_catamorphism_fun R (neg x) + cring_catamorphism_fun R (neg y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr)
  (pos_succ (x + y)%pos) =
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk4b"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> pos_peano_rec_beta_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (neg x + neg y)%int =
cring_catamorphism_fun R (neg x) + cring_catamorphism_fun R (neg y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">-<span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (x + y)%pos =
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x +
(-<span class="mi">1</span> +
 pos_peano_rec R (-<span class="mi">1</span>)
   (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk4c"><span class="highlight"><span class="nb">rewrite</span> simple_associativity.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (neg x + neg y)%int =
cring_catamorphism_fun R (neg x) + cring_catamorphism_fun R (neg y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">-<span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (x + y)%pos =
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x - <span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk4d"><span class="highlight"><span class="nb">rewrite</span> (commutativity _ (-<span class="mi">1</span>)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (neg x + neg y)%int =
cring_catamorphism_fun R (neg x) + cring_catamorphism_fun R (neg y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">-<span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (x + y)%pos =
-<span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk4e"><span class="highlight"><span class="nb">rewrite</span> &lt;- simple_associativity.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (neg x + neg y)%int =
cring_catamorphism_fun R (neg x) + cring_catamorphism_fun R (neg y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">-<span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (x + y)%pos =
-<span class="mi">1</span> +
(pos_peano_rec R (-<span class="mi">1</span>)
   (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x +
 pos_peano_rec R (-<span class="mi">1</span>)
   (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight">f_ap.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk4f"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (pos y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk50" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk50"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (neg y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chk51" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk51"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (pos y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  <span class="sd">(** x &lt; 0 , y &gt; 0 *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk52"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (pos y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk53"><span class="highlight"><span class="nb">cbn</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub y x) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk54"><span class="highlight"><span class="nb">revert</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk55"><span class="highlight"><span class="nb">induction</span> y <span class="kr">as</span> [|y IHy] <span class="nb">using</span> pos_peano_ind; <span class="nb">intro</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub <span class="mi">1</span>%pos x) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk56" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk56"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk57"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub <span class="mi">1</span>%pos x) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk58"><span class="highlight"><span class="nb">cbn</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub <span class="mi">1</span>%pos x) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk59"><span class="highlight"><span class="nb">induction</span> x <span class="kr">as</span> [|x] <span class="nb">using</span> pos_peano_ind.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub <span class="mi">1</span>%pos <span class="mi">1</span>%pos) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos) <span class="mi">1</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk5a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub <span class="mi">1</span>%pos x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk5a"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub <span class="mi">1</span>%pos (pos_succ x)) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ x))
  <span class="mi">1</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk5b"><span class="highlight"><span class="mi">1</span>: <span class="nb">symmetry</span>; <span class="nb">cbn</span>; <span class="nb">apply</span> left_inverse.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub <span class="mi">1</span>%pos x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub <span class="mi">1</span>%pos (pos_succ x)) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ x))
  <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk5c"><span class="highlight"><span class="nb">rewrite</span> pos_peano_rec_beta_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub <span class="mi">1</span>%pos x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub <span class="mi">1</span>%pos (pos_succ x)) =
sg_op
  (-<span class="mi">1</span> +
   pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk5d"><span class="highlight"><span class="nb">rewrite</span> int_pos_sub_succ_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub <span class="mi">1</span>%pos x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (neg x) =
sg_op
  (-<span class="mi">1</span> +
   pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk5e"><span class="highlight"><span class="nb">cbn</span>; <span class="nb">rewrite</span> &lt;- simple_associativity.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub <span class="mi">1</span>%pos x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x =
sg_op (-<span class="mi">1</span>)
  (sg_op
     (pos_peano_rec R (-<span class="mi">1</span>)
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk5f"><span class="highlight"><span class="nb">apply</span> rng_moveL_Mr.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub <span class="mi">1</span>%pos x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">- (-<span class="mi">1</span>) +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk60"><span class="highlight"><span class="nb">cbn</span>; <span class="nb">rewrite</span> involutive.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub <span class="mi">1</span>%pos x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> commutativity.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk61"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk62"><span class="highlight"><span class="nb">induction</span> x <span class="kr">as</span> [|x IHx] <span class="nb">using</span> pos_peano_ind.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub (pos_succ y) <span class="mi">1</span>%pos) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk63" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk63"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub (pos_succ y) (pos_succ x)) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ x))
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk64"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub (pos_succ y) <span class="mi">1</span>%pos) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk65"><span class="highlight"><span class="nb">rewrite</span> int_pos_sub_succ_l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (pos y) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk66"><span class="highlight"><span class="nb">cbn</span>; <span class="nb">apply</span> rng_moveL_Mr.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">- (-<span class="mi">1</span>) +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y =
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (pos_succ y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk67"><span class="highlight"><span class="nb">cbn</span>; <span class="nb">rewrite</span> involutive.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y =
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (pos_succ y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> pos_peano_rec_beta_pos_succ.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk68"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub (pos_succ y) (pos_succ x)) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ x))
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk69"><span class="highlight"><span class="nb">rewrite</span> int_pos_sub_succ_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub y x) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ x))
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk6a"><span class="highlight"><span class="nb">rewrite</span> IHy.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ x))
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk6b"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> pos_peano_rec_beta_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y) =
sg_op
  (-<span class="mi">1</span> +
   pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (<span class="mi">1</span> +
   pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk6c"><span class="highlight"><span class="nb">rewrite</span> (commutativity (-<span class="mi">1</span>)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y) =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x - <span class="mi">1</span>)
  (<span class="mi">1</span> +
   pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk6d"><span class="highlight"><span class="nb">rewrite</span> simple_associativity.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y) =
sg_op
  (sg_op
     (pos_peano_rec R (-<span class="mi">1</span>)
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x - <span class="mi">1</span>) <span class="mi">1</span>)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk6e"><span class="highlight"><span class="nb">rewrite</span> &lt;- (simple_associativity _ _ <span class="mi">1</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y) =
sg_op
  (sg_op
     (pos_peano_rec R (-<span class="mi">1</span>)
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
     (sg_op (-<span class="mi">1</span>) <span class="mi">1</span>))
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk6f"><span class="highlight"><span class="nb">rewrite</span> left_inverse.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y) =
sg_op
  (sg_op
     (pos_peano_rec R (-<span class="mi">1</span>)
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
     mon_unit)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk70"><span class="highlight">f_ap.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x =
sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) mon_unit</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk71"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub y x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub (pos_succ y) x) =
sg_op (pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x) mon_unit =
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> right_identity.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk72"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (neg y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk73" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk73"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (pos y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk74"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (neg y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk75"><span class="highlight"><span class="nb">cbn</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x y) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk76"><span class="highlight"><span class="nb">revert</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk77"><span class="highlight"><span class="nb">induction</span> y <span class="kr">as</span> [|y IHy] <span class="nb">using</span> pos_peano_ind; <span class="nb">intro</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x <span class="mi">1</span>%pos) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk78" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk78"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x (pos_succ y)) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk79"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x <span class="mi">1</span>%pos) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk7a"><span class="highlight"><span class="nb">induction</span> x <span class="kr">as</span> [|x] <span class="nb">using</span> pos_peano_ind.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub <span class="mi">1</span>%pos <span class="mi">1</span>%pos) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) <span class="mi">1</span>%pos)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk7b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x <span class="mi">1</span>%pos) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk7b"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub (pos_succ x) <span class="mi">1</span>%pos) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ x))
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk7c"><span class="highlight"><span class="mi">1</span>: <span class="nb">symmetry</span>; <span class="nb">cbn</span>; <span class="nb">apply</span> right_inverse.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x <span class="mi">1</span>%pos) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub (pos_succ x) <span class="mi">1</span>%pos) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ x))
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk7d"><span class="highlight"><span class="nb">rewrite</span> pos_peano_rec_beta_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x <span class="mi">1</span>%pos) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub (pos_succ x) <span class="mi">1</span>%pos) =
sg_op
  (<span class="mi">1</span> +
   pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk7e"><span class="highlight"><span class="nb">rewrite</span> (commutativity <span class="mi">1</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x <span class="mi">1</span>%pos) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub (pos_succ x) <span class="mi">1</span>%pos) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x + <span class="mi">1</span>)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk7f"><span class="highlight"><span class="nb">rewrite</span> &lt;- simple_associativity.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x <span class="mi">1</span>%pos) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub (pos_succ x) <span class="mi">1</span>%pos) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (sg_op <span class="mi">1</span>
     (pos_peano_rec R (-<span class="mi">1</span>)
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk80"><span class="highlight"><span class="nb">rewrite</span> int_pos_sub_succ_l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x <span class="mi">1</span>%pos) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (pos x) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (sg_op <span class="mi">1</span>
     (pos_peano_rec R (-<span class="mi">1</span>)
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) <span class="mi">1</span>%pos))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">cbn</span>; <span class="bp">by</span> <span class="nb">rewrite</span> right_inverse, right_identity.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk81"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x (pos_succ y)) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk82"><span class="highlight"><span class="nb">induction</span> x <span class="kr">as</span> [|x IHx] <span class="nb">using</span> pos_peano_ind.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub <span class="mi">1</span>%pos (pos_succ y)) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) <span class="mi">1</span>%pos)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk83" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x (pos_succ y)) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk83"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub (pos_succ x) (pos_succ y)) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ x))
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk84"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub <span class="mi">1</span>%pos (pos_succ y)) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) <span class="mi">1</span>%pos)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk85"><span class="highlight"><span class="nb">rewrite</span> int_pos_sub_succ_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (neg y) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) <span class="mi">1</span>%pos)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk86"><span class="highlight"><span class="nb">rewrite</span> pos_peano_rec_beta_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (neg y) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) <span class="mi">1</span>%pos)
  (-<span class="mi">1</span> +
   pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk87"><span class="highlight"><span class="nb">rewrite</span> simple_associativity.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (neg y) =
sg_op
  (sg_op
     (pos_peano_rec R <span class="mi">1</span>
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) <span class="mi">1</span>%pos) 
     (-<span class="mi">1</span>))
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk88"><span class="highlight"><span class="nb">cbn</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y =
sg_op (sg_op <span class="mi">1</span> (-<span class="mi">1</span>))
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk89"><span class="highlight"><span class="nb">rewrite</span> (right_inverse <span class="mi">1</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y =
sg_op mon_unit
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk8a"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op mon_unit
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y) =
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> left_identity.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk8b"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x (pos_succ y)) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (int_pos_sub (pos_succ x) (pos_succ y)) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ x))
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk8c"><span class="highlight"><span class="nb">rewrite</span> int_pos_sub_succ_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x (pos_succ y)) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x y) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ x))
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk8d"><span class="highlight"><span class="nb">rewrite</span> IHy.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x (pos_succ y)) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ x))
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk8e"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> pos_peano_rec_beta_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x (pos_succ y)) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y) =
sg_op
  (<span class="mi">1</span> +
   pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (-<span class="mi">1</span> +
   pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk8f"><span class="highlight"><span class="nb">rewrite</span> (commutativity <span class="mi">1</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x (pos_succ y)) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x + <span class="mi">1</span>)
  (-<span class="mi">1</span> +
   pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk90"><span class="highlight"><span class="nb">rewrite</span> simple_associativity.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x (pos_succ y)) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y) =
sg_op
  (sg_op
     (pos_peano_rec R <span class="mi">1</span>
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x + <span class="mi">1</span>) 
     (-<span class="mi">1</span>))
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk91"><span class="highlight"><span class="nb">rewrite</span> &lt;- (simple_associativity _ _ (-<span class="mi">1</span>)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x (pos_succ y)) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y) =
sg_op
  (sg_op
     (pos_peano_rec R <span class="mi">1</span>
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
     (sg_op <span class="mi">1</span> (-<span class="mi">1</span>)))
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk92"><span class="highlight"><span class="nb">rewrite</span> (right_inverse <span class="mi">1</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x (pos_succ y)) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y) =
sg_op
  (sg_op
     (pos_peano_rec R <span class="mi">1</span>
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x) mon_unit)
  (pos_peano_rec R (-<span class="mi">1</span>)
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk93"><span class="highlight">f_ap; <span class="nb">symmetry</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Pos,
cring_catamorphism_fun R (int_pos_sub x y) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_catamorphism_fun R (int_pos_sub x (pos_succ y)) =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R (-<span class="mi">1</span>) (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ y))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x) mon_unit =
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> right_identity.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk94"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (pos y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk95"><span class="highlight"><span class="nb">cbn</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (x + y)%pos =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk96"><span class="highlight"><span class="nb">induction</span> y <span class="kr">as</span> [|y IHy] <span class="nb">using</span> pos_peano_ind.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (x + <span class="mi">1</span>)%pos =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk97" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (x + y)%pos =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk97"><hr></label><div class="goal-conclusion"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (x + pos_succ y)%pos =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk98"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (x + <span class="mi">1</span>)%pos =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) <span class="mi">1</span>%pos)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk99"><span class="highlight"><span class="nb">cbn</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (x + <span class="mi">1</span>)%pos =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x) <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk9a"><span class="highlight"><span class="nb">rewrite</span> pos_add_1_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (pos_succ x) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x) <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk9b"><span class="highlight"><span class="nb">rewrite</span> pos_peano_rec_beta_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x) <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> commutativity.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk9c"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (x + y)%pos =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (x + pos_succ y)%pos =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk9d"><span class="highlight"><span class="nb">rewrite</span> pos_add_succ_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (x + y)%pos =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (pos_succ (x + y)%pos) =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (pos_succ y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk9e"><span class="highlight"><span class="nb">rewrite</span> <span class="mi">2</span> pos_peano_rec_beta_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (x + y)%pos =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (x + y)%pos =
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (<span class="mi">1</span> +
   pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk9f"><span class="highlight"><span class="nb">rewrite</span> simple_associativity.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (x + y)%pos =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (x + y)%pos =
sg_op
  (sg_op
     (pos_peano_rec R <span class="mi">1</span>
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x) <span class="mi">1</span>)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chka0"><span class="highlight"><span class="nb">rewrite</span> IHy.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (x + y)%pos =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> +
sg_op
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y) =
sg_op
  (sg_op
     (pos_peano_rec R <span class="mi">1</span>
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x) <span class="mi">1</span>)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chka1"><span class="highlight"><span class="nb">rewrite</span> simple_associativity.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (x + y)%pos =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y =
sg_op
  (sg_op
     (pos_peano_rec R <span class="mi">1</span>
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x) <span class="mi">1</span>)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chka2"><span class="highlight"><span class="nb">rewrite</span> (commutativity <span class="mi">1</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHy</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) (x + y)%pos =
sg_op (pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x)
(pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x +
<span class="mi">1</span> +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y =
sg_op
  (sg_op
     (pos_peano_rec R <span class="mi">1</span>
        (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) x) <span class="mi">1</span>)
  (pos_peano_rec R <span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chka3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">cring_catamorphism_fun_negate</span> {<span class="nv">R</span>} <span class="nv">x</span>
  : cring_catamorphism_fun R (- x) = - cring_catamorphism_fun R x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (- x) =
- cring_catamorphism_fun R x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chka4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (- x) =
- cring_catamorphism_fun R x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chka5"><span class="highlight">snrapply (groups.preserves_negate _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">SgOp cring_Z</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chka6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chka6"><hr></label><div class="goal-conclusion"><span class="highlight">MonUnit cring_Z</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chka7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chka7"><hr></label><div class="goal-conclusion"><span class="highlight">IsGroup cring_Z</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chka8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chka8"><hr></label><div class="goal-conclusion"><span class="highlight">SgOp R</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chka9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chka9"><hr></label><div class="goal-conclusion"><span class="highlight">MonUnit R</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkaa" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkaa"><hr></label><div class="goal-conclusion"><span class="highlight">IsGroup R</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkab" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkab"><hr></label><div class="goal-conclusion"><span class="highlight">IsMonoidPreserving (cring_catamorphism_fun R)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkac"><span class="highlight"><span class="mi">1</span>-<span class="mi">6</span>: <span class="bp">exact</span> _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsMonoidPreserving (cring_catamorphism_fun R)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkad"><span class="highlight">snrapply Build_IsMonoidPreserving.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsSemiGroupPreserving (cring_catamorphism_fun R)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chkae" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkae"><hr></label><div class="goal-conclusion"><span class="highlight">IsUnitPreserving (cring_catamorphism_fun R)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkaf"><span class="highlight"><span class="mi">1</span>: <span class="bp">exact</span> _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsUnitPreserving (cring_catamorphism_fun R)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">split</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkb0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">cring_catamorphism_fun_pos_mult</span> {<span class="nv">R</span>} <span class="nv">x</span> <span class="nv">y</span>
  : cring_catamorphism_fun R (pos x * pos y)%int
    = cring_catamorphism_fun R (pos x) * cring_catamorphism_fun R (pos y).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkb1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkb2"><span class="highlight"><span class="nb">revert</span> y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Pos,
cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkb3"><span class="highlight"><span class="nb">induction</span> x <span class="kr">as</span> [|x IHx] <span class="nb">using</span> pos_peano_ind; <span class="nb">intro</span> y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (<span class="mi">1</span> * pos y)%int =
cring_catamorphism_fun R <span class="mi">1</span>%int *
cring_catamorphism_fun R (pos y)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chkb4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Pos,
cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) * cring_catamorphism_fun R (pos y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkb4"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (pos (pos_succ x) * pos y)%int =
cring_catamorphism_fun R (pos (pos_succ x)) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkb5"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (<span class="mi">1</span> * pos y)%int =
cring_catamorphism_fun R <span class="mi">1</span>%int *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkb6"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R <span class="mi">1</span>%int *
cring_catamorphism_fun R (pos y) =
cring_catamorphism_fun R (<span class="mi">1</span> * pos y)%int</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> left_identity.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkb7"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Pos,
cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) * cring_catamorphism_fun R (pos y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (pos (pos_succ x) * pos y)%int =
cring_catamorphism_fun R (pos (pos_succ x)) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkb8"><span class="highlight"><span class="nb">change</span> (cring_catamorphism_fun R (pos (pos_succ x * y)%pos)
    = cring_catamorphism_fun R (pos (pos_succ x)) * cring_catamorphism_fun R (pos y)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Pos,
cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) * cring_catamorphism_fun R (pos y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (pos (pos_succ x * y)%pos) =
cring_catamorphism_fun R (pos (pos_succ x)) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkb9"><span class="highlight"><span class="nb">rewrite</span> pos_mul_succ_l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Pos,
cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) * cring_catamorphism_fun R (pos y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (pos (x * y + y)%pos) =
cring_catamorphism_fun R (pos (pos_succ x)) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkba"><span class="highlight"><span class="nb">refine</span> (issemigrouppreserving_cring_catamorphism_fun_plus
    R (pos (x * y)%pos) (pos y) @ _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Pos,
cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) * cring_catamorphism_fun R (pos y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op (cring_catamorphism_fun R (pos (x * y)%pos))
  (cring_catamorphism_fun R (pos y)) =
cring_catamorphism_fun R (pos (pos_succ x)) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkbb"><span class="highlight"><span class="nb">rewrite</span> IHx.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Pos,
cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) * cring_catamorphism_fun R (pos y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (cring_catamorphism_fun R (pos x) *
   cring_catamorphism_fun R (pos y))
  (cring_catamorphism_fun R (pos y)) =
cring_catamorphism_fun R (pos (pos_succ x)) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkbc"><span class="highlight"><span class="nb">transitivity</span> ((<span class="mi">1</span> + cring_catamorphism_fun R (pos x)) * cring_catamorphism_fun R (pos y)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Pos,
cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) * cring_catamorphism_fun R (pos y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (cring_catamorphism_fun R (pos x) *
   cring_catamorphism_fun R (pos y))
  (cring_catamorphism_fun R (pos y)) =
(<span class="mi">1</span> + cring_catamorphism_fun R (pos x)) *
cring_catamorphism_fun R (pos y)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chkbd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Pos,
cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) * cring_catamorphism_fun R (pos y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkbd"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="mi">1</span> + cring_catamorphism_fun R (pos x)) *
cring_catamorphism_fun R (pos y) =
cring_catamorphism_fun R (pos (pos_succ x)) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkbe"><span class="highlight"><span class="mi">2</span>: <span class="nb">simpl</span>; <span class="bp">by</span> <span class="nb">rewrite</span> pos_peano_rec_beta_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Pos,
cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) * cring_catamorphism_fun R (pos y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (cring_catamorphism_fun R (pos x) *
   cring_catamorphism_fun R (pos y))
  (cring_catamorphism_fun R (pos y)) =
(<span class="mi">1</span> + cring_catamorphism_fun R (pos x)) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkbf"><span class="highlight"><span class="nb">rewrite</span> rng_dist_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Pos,
cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) * cring_catamorphism_fun R (pos y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (cring_catamorphism_fun R (pos x) *
   cring_catamorphism_fun R (pos y))
  (cring_catamorphism_fun R (pos y)) =
<span class="mi">1</span> * cring_catamorphism_fun R (pos y) +
cring_catamorphism_fun R (pos x) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkc0"><span class="highlight"><span class="nb">rewrite</span> rng_mult_one_l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : Pos,
cring_catamorphism_fun R (pos x * pos y)%int =
cring_catamorphism_fun R (pos x) * cring_catamorphism_fun R (pos y)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sg_op
  (cring_catamorphism_fun R (pos x) *
   cring_catamorphism_fun R (pos y))
  (cring_catamorphism_fun R (pos y)) =
cring_catamorphism_fun R (pos y) +
cring_catamorphism_fun R (pos x) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> commutativity.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** Preservation of * (multiplication) *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkc1"><span class="highlight"><span class="kn">Instance</span> <span class="nf">issemigrouppreserving_cring_catamorphism_fun_mult</span> (<span class="nv">R</span> : CRing)
  : IsSemiGroupPreserving (Aop:=cring_mult) (Bop:=cring_mult)
      (cring_catamorphism_fun R : cring_Z -&gt; R).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsSemiGroupPreserving
  (cring_catamorphism_fun R : cring_Z -&gt; R)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkc2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsSemiGroupPreserving
  (cring_catamorphism_fun R : cring_Z -&gt; R)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkc3"><span class="highlight"><span class="nb">hnf</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : cring_Z,
cring_catamorphism_fun R (sg_op x y) =
sg_op (cring_catamorphism_fun R x)
  (cring_catamorphism_fun R y)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkc4"><span class="highlight"><span class="nb">intros</span> [x| |x] [y| |y].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (neg y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chkc5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkc5"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) <span class="mi">0</span>%int) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R <span class="mi">0</span>%int)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkc6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkc6"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (pos y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkc7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkc7"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op <span class="mi">0</span>%int (neg y)) =
sg_op (cring_catamorphism_fun R <span class="mi">0</span>%int)
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkc8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkc8"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op <span class="mi">0</span>%int <span class="mi">0</span>%int) =
sg_op (cring_catamorphism_fun R <span class="mi">0</span>%int)
  (cring_catamorphism_fun R <span class="mi">0</span>%int)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkc9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkc9"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op <span class="mi">0</span>%int (pos y)) =
sg_op (cring_catamorphism_fun R <span class="mi">0</span>%int)
  (cring_catamorphism_fun R (pos y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkca" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkca"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (neg y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkcb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkcb"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) <span class="mi">0</span>%int) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R <span class="mi">0</span>%int)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkcc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkcc"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (pos y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkcd"><span class="highlight"><span class="mi">2</span>,<span class="mi">5</span>,<span class="mi">8</span>: <span class="nb">symmetry</span>; <span class="nb">apply</span> rng_mult_zero_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (neg y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chkce" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkce"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (pos y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkcf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkcf"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op <span class="mi">0</span>%int (neg y)) =
sg_op (cring_catamorphism_fun R <span class="mi">0</span>%int)
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkd0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkd0"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op <span class="mi">0</span>%int (pos y)) =
sg_op (cring_catamorphism_fun R <span class="mi">0</span>%int)
  (cring_catamorphism_fun R (pos y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkd1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkd1"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (neg y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkd2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkd2"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (pos y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkd3"><span class="highlight"><span class="mi">3</span>,<span class="mi">4</span>: <span class="nb">cbn</span>; <span class="nb">symmetry</span>; <span class="nb">rewrite</span> (commutativity <span class="mi">0</span>); <span class="nb">apply</span> rng_mult_zero_r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (neg y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chkd4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkd4"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (pos y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkd5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkd5"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (neg y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkd6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkd6"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (pos y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkd7"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (neg y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkd8"><span class="highlight"><span class="nb">change</span> (cring_catamorphism_fun R (pos (x * y)%pos)
      = cring_catamorphism_fun R (- (pos x : cring_Z))
        * cring_catamorphism_fun R (- (pos y : cring_Z))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (pos (x * y)%pos) =
cring_catamorphism_fun R (- (pos x : cring_Z)) *
cring_catamorphism_fun R (- (pos y : cring_Z))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span> cring_catamorphism_fun_negate, cring_catamorphism_fun_pos_mult,
      rng_mult_negate_negate.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkd9"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (pos y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chkda" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkda"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (neg y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkdb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkdb"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (pos y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkdc"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (neg x) (pos y)) =
sg_op (cring_catamorphism_fun R (neg x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkdd"><span class="highlight"><span class="nb">change</span> (cring_catamorphism_fun R (- (pos (x * y)%pos : cring_Z))
      = cring_catamorphism_fun R (- (pos x : cring_Z))
        * cring_catamorphism_fun R (pos y)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (- (pos (x * y)%pos : cring_Z)) =
cring_catamorphism_fun R (- (pos x : cring_Z)) *
cring_catamorphism_fun R (pos y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span> cring_catamorphism_fun_negate, cring_catamorphism_fun_pos_mult, rng_mult_negate_l.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkde"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (neg y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chkdf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkdf"><hr></label><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (pos y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chke0"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (neg y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (neg y))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chke1"><span class="highlight"><span class="nb">change</span> (cring_catamorphism_fun R (- (pos (x * y)%pos : cring_Z))
      = cring_catamorphism_fun R (pos x)
        * cring_catamorphism_fun R (- (pos y : cring_Z))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R
  (- (pos (x * y)%pos : cring_Z)) =
cring_catamorphism_fun R (pos x) *
cring_catamorphism_fun R (- (pos y : cring_Z))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span> cring_catamorphism_fun_negate, cring_catamorphism_fun_pos_mult, rng_mult_negate_r.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chke2"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_catamorphism_fun R (sg_op (pos x) (pos y)) =
sg_op (cring_catamorphism_fun R (pos x))
  (cring_catamorphism_fun R (pos y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> cring_catamorphism_fun_pos_mult.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** This is a ring homomorphism *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chke3"><span class="highlight"><span class="kn">Definition</span> <span class="nf">rng_homo_int</span> (<span class="nv">R</span> : CRing) : cring_Z $-&gt; R.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_Z $-&gt; R</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chke4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_Z $-&gt; R</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chke5"><span class="highlight">snrapply Build_CRingHomomorphism.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cring_Z -&gt; R</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chke6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chke6"><hr></label><div class="goal-conclusion"><span class="highlight">IsSemiRingPreserving <span class="nl">?rng_homo_map</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chke7"><span class="highlight"><span class="mi">1</span>: <span class="bp">exact</span> (cring_catamorphism_fun R).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsSemiRingPreserving (cring_catamorphism_fun R)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kp">repeat</span> <span class="nb">split</span>; <span class="bp">exact</span> _.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** The integers are the initial commutative ring *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chke8"><span class="highlight"><span class="kn">Instance</span> <span class="nf">isinitial_cring_Z</span> : IsInitial cring_Z.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsInitial cring_Z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chke9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsInitial cring_Z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkea"><span class="highlight"><span class="nb">unfold</span> IsInitial.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : CRing,
{f : cring_Z $-&gt; y &amp;
<span class="kr">forall</span> <span class="nv">g</span> : cring_Z $-&gt; y, g $== f}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkeb"><span class="highlight"><span class="nb">intro</span> R.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{f : cring_Z $-&gt; R &amp;
<span class="kr">forall</span> <span class="nv">g</span> : cring_Z $-&gt; R, g $== f}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkec"><span class="highlight"><span class="kr">exists</span> (<span class="nv">rng_homo_int</span> <span class="nv">R</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">g</span> : cring_Z $-&gt; R, g $== rng_homo_int R</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chked"><span class="highlight"><span class="nb">intros</span> g x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g x = rng_homo_int R x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkee"><span class="highlight"><span class="nb">destruct</span> x <span class="kr">as</span> [n| |p].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (neg n) = rng_homo_int R (neg n)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chkef" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkef"><hr></label><div class="goal-conclusion"><span class="highlight">g <span class="mi">0</span>%int = rng_homo_int R <span class="mi">0</span>%int</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="z-v-chkf0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkf0"><hr></label><div class="goal-conclusion"><span class="highlight">g (pos p) = rng_homo_int R (pos p)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkf1"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (neg n) = rng_homo_int R (neg n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkf2"><span class="highlight"><span class="nb">induction</span> n <span class="nb">using</span> pos_peano_ind.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (-<span class="mi">1</span>)%int = rng_homo_int R (-<span class="mi">1</span>)%int</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chkf3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (neg n) = rng_homo_int R (neg n)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chkf3"><hr></label><div class="goal-conclusion"><span class="highlight">g (neg (pos_succ n)) =
rng_homo_int R (neg (pos_succ n))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkf4"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (-<span class="mi">1</span>)%int = rng_homo_int R (-<span class="mi">1</span>)%int</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkf5"><span class="highlight"><span class="nb">cbn</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (-<span class="mi">1</span>)%int = -<span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight">rapply rng_homo_minus_one.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkf6"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (neg n) = rng_homo_int R (neg n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (neg (pos_succ n)) =
rng_homo_int R (neg (pos_succ n))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkf7"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (neg n) = rng_homo_int R (neg n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (neg (pos_succ n)) =
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) (pos_succ n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkf8"><span class="highlight"><span class="nb">rewrite</span> pos_peano_rec_beta_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (neg n) = rng_homo_int R (neg n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (neg (pos_succ n)) =
-<span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkf9"><span class="highlight"><span class="nb">rewrite</span> int_neg_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (neg n) = rng_homo_int R (neg n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (int_pred (neg n)) =
-<span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkfa"><span class="highlight"><span class="nb">unfold</span> int_pred.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (neg n) = rng_homo_int R (neg n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (neg n + -<span class="mi">1</span>)%int =
-<span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkfb"><span class="highlight"><span class="nb">rewrite</span> int_add_comm.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (neg n) = rng_homo_int R (neg n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (-<span class="mi">1</span> + neg n)%int =
-<span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkfc"><span class="highlight"><span class="nb">rewrite</span> rng_homo_plus.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (neg n) = rng_homo_int R (neg n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (-<span class="mi">1</span>)%int + g (neg n) =
-<span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkfd"><span class="highlight"><span class="nb">rewrite</span> rng_homo_minus_one.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (neg n) = rng_homo_int R (neg n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">-<span class="mi">1</span> + g (neg n) =
-<span class="mi">1</span> +
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkfe"><span class="highlight"><span class="nb">apply</span> ap.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (neg n) = rng_homo_int R (neg n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (neg n) =
pos_peano_rec R (-<span class="mi">1</span>)
  (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; -<span class="mi">1</span> + nr) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> IHn.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chkff"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g <span class="mi">0</span>%int = rng_homo_int R <span class="mi">0</span>%int</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span> rng_homo_zero.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk100"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (pos p) = rng_homo_int R (pos p)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk101"><span class="highlight"><span class="nb">induction</span> p <span class="nb">using</span> pos_peano_ind.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g <span class="mi">1</span>%int = rng_homo_int R <span class="mi">1</span>%int</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="z-v-chk102" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (pos p) = rng_homo_int R (pos p)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="z-v-chk102"><hr></label><div class="goal-conclusion"><span class="highlight">g (pos (pos_succ p)) =
rng_homo_int R (pos (pos_succ p))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk103"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g <span class="mi">1</span>%int = rng_homo_int R <span class="mi">1</span>%int</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk104"><span class="highlight"><span class="nb">cbn</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g <span class="mi">1</span>%int = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight">rapply rng_homo_one.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk105"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (pos p) = rng_homo_int R (pos p)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (pos (pos_succ p)) =
rng_homo_int R (pos (pos_succ p))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk106"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (pos p) = rng_homo_int R (pos p)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (pos (pos_succ p)) =
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr)
  (pos_succ p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk107"><span class="highlight"><span class="nb">rewrite</span> pos_peano_rec_beta_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (pos p) = rng_homo_int R (pos p)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (pos (pos_succ p)) =
<span class="mi">1</span> +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk108"><span class="highlight"><span class="nb">rewrite</span> int_pos_pos_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (pos p) = rng_homo_int R (pos p)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (int_succ (pos p)) =
<span class="mi">1</span> +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk109"><span class="highlight"><span class="nb">unfold</span> int_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (pos p) = rng_homo_int R (pos p)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (pos p + <span class="mi">1</span>)%int =
<span class="mi">1</span> +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk10a"><span class="highlight"><span class="nb">rewrite</span> int_add_comm.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (pos p) = rng_homo_int R (pos p)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (<span class="mi">1</span> + pos p)%int =
<span class="mi">1</span> +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk10b"><span class="highlight"><span class="nb">rewrite</span> rng_homo_plus.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (pos p) = rng_homo_int R (pos p)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g <span class="mi">1</span>%int + g (pos p) =
<span class="mi">1</span> +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk10c"><span class="highlight"><span class="nb">rewrite</span> rng_homo_one.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (pos p) = rng_homo_int R (pos p)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> + g (pos p) =
<span class="mi">1</span> +
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="z-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="z-v-chk10d"><span class="highlight"><span class="nb">apply</span> ap.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">R</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">CRing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">cring_Z $-&gt; R</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Pos</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g (pos p) = rng_homo_int R (pos p)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (pos p) =
pos_peano_rec R <span class="mi">1</span> (<span class="kr">fun</span> (<span class="nv">_</span> : Pos) (<span class="nv">nr</span> : R) =&gt; <span class="mi">1</span> + nr) p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> IHp.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span></span></pre>
</div>
</div></body>
</html>
