<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>HoTTBookExercises.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="tango_subtle.css" type="text/css" />
<link rel="stylesheet" href="tango_subtle.min.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.13.0+0.13.0. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="highlight"><span class="sd">(** The HoTT Book Exercises formalization. *)</span>

<span class="sd">(** This file records formalized solutions to the HoTT Book exercises. *)</span>

<span class="c">(*  See HoTTBook.v for an IMPORTANT NOTE FOR THE HoTT DEVELOPERS.</span>

<span class="c">    PROCEDURE FOR UPDATING THE FILE:</span>

<span class="c">   1. Compile the latest version of the HoTT Book to update the LaTeX</span>
<span class="c">      labels. Do not forget to pull in changes from HoTT/HoTT.</span>

<span class="c">   2. Run `etc/Book.py` using the `--exercises` flag (so your command</span>
<span class="c">      should look like `cat ../book/*.aux | etc/Book.py --exercises contrib/HoTTBookExercises.v`)</span>
<span class="c">      If it complains, fix things.</span>

<span class="c">   3. Add contents to new entries.</span>

<span class="c">   4. Run `etc/Book.py` again to make sure it is happy.</span>

<span class="c">   5. Compile this file with `make contrib` or `make contrib/HoTTBookExercises.vo`.</span>

<span class="c">   6. Do the git thing to submit your changes.</span>

<span class="c">*)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> HoTT.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> Spaces.Nat.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> HoTT.Metatheory.Core HoTT.Metatheory.FunextVarieties HoTT.Metatheory.UnivalenceImpliesFunext.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Local Open Scope</span> nat_scope.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Local Open Scope</span> type_scope.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Local Open Scope</span> path_scope.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* END OF PREAMBLE *)</span>
<span class="c">(* ================================================== ex:composition *)</span>
<span class="sd">(** Exercise 1.1 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_1_1</span> := (<span class="kr">fun</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : B -&gt; C) =&gt; g o f).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk0"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Book_1_1_refl</span> : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : B -&gt; C) (<span class="nv">h</span> : C -&gt; D),
                          h o (g o f) = (h o g) o f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : B -&gt; C)
(<span class="nv">h</span> : C -&gt; D), h o (g o f) = h o g o f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : B -&gt; C)
(<span class="nv">h</span> : C -&gt; D), h o (g o f) = h o g o f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:pr-to-rec *)</span>
<span class="sd">(** Exercise 1.2 *)</span>

<span class="sd">(** Recursor as equivalence. *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_1_2_prod_lib</span> := @HoTT.Types.Prod.equiv_uncurry.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_1_2_prod</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="sd">(** Recursor with projection functions instead of pattern-matching. *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">prod_rec_proj</span> <span class="nv">C</span> (<span class="nv">g</span> : A -&gt; B -&gt; C) (<span class="nv">p</span> : A * B) : C :=
    g (fst p) (snd p).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_1_2_prod</span> := prod_rec_proj.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2"><span class="highlight"><span class="kn">Proposition</span> <span class="nf">Book_1_2_prod_fst</span> : fst = prod_rec_proj A (<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">b</span> =&gt; a).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">prod_rec_proj</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : A -&gt; B -&gt; C)
  (<span class="nv">p</span> : A * B) =&gt; g (fst p) (snd p)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>,
(A -&gt; B -&gt; C) -&gt; A * B -&gt; C</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fst = prod_rec_proj A (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">_</span> : B) =&gt; a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">prod_rec_proj</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : A -&gt; B -&gt; C)
  (<span class="nv">p</span> : A * B) =&gt; g (fst p) (snd p)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>,
(A -&gt; B -&gt; C) -&gt; A * B -&gt; C</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fst = prod_rec_proj A (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">_</span> : B) =&gt; a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4"><span class="highlight"><span class="kn">Proposition</span> <span class="nf">Book_1_2_prod_snd</span> : snd = prod_rec_proj B (<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">b</span> =&gt; b).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">prod_rec_proj</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : A -&gt; B -&gt; C)
  (<span class="nv">p</span> : A * B) =&gt; g (fst p) (snd p)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>,
(A -&gt; B -&gt; C) -&gt; A * B -&gt; C</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">snd = prod_rec_proj B (<span class="kr">fun</span> <span class="nv">_</span> : A =&gt; idmap)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">prod_rec_proj</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : A -&gt; B -&gt; C)
  (<span class="nv">p</span> : A * B) =&gt; g (fst p) (snd p)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>,
(A -&gt; B -&gt; C) -&gt; A * B -&gt; C</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">snd = prod_rec_proj B (<span class="kr">fun</span> <span class="nv">_</span> : A =&gt; idmap)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_1_2_prod</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** Recursor as (dependent) equivalence. *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_1_2_sig_lib</span> := @HoTT.Types.Sigma.equiv_sig_ind.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_1_2_sig</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">A</span> : <span class="kt">Type</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">B</span> : A -&gt; <span class="kt">Type</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="sd">(** Non-dependent recursor with projection functions instead of pattern matching. *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">sig_rec_proj</span> <span class="nv">C</span> (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">x</span> : A), B x -&gt; C) (<span class="nv">p</span> : <span class="kr">exists</span> (<span class="nv">x</span> : A), B x) : C :=
    g (pr1 p) (pr2 p).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_1_2_sig</span> := @sig_rec_proj.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6"><span class="highlight"><span class="kn">Proposition</span> <span class="nf">Book_1_2_sig_fst</span> : @pr1 A B = sig_rec_proj A (<span class="kr">fun</span> <span class="nv">a</span> =&gt; <span class="kr">fun</span> <span class="nv">b</span> =&gt; a).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sig_rec_proj</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">C</span> : <span class="kt">Type</span>)
  (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">x</span> : A, B x -&gt; C)
  (<span class="nv">p</span> : {x : A &amp; B x}) =&gt; 
g p.<span class="mi">1</span> p.<span class="mi">2</span></span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">x</span> : A, B x -&gt; C) -&gt;
{x : A &amp; B x} -&gt; C</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pr1 = sig_rec_proj A (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">_</span> : B a) =&gt; a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sig_rec_proj</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">C</span> : <span class="kt">Type</span>)
  (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">x</span> : A, B x -&gt; C)
  (<span class="nv">p</span> : {x : A &amp; B x}) =&gt; 
g p.<span class="mi">1</span> p.<span class="mi">2</span></span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">x</span> : A, B x -&gt; C) -&gt;
{x : A &amp; B x} -&gt; C</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">pr1 = sig_rec_proj A (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">_</span> : B a) =&gt; a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="sd">(** NB: You cannot implement pr2 with only the recursor, so it is not possible</span>
<span class="sd">      to check its definitional equality as the exercise suggests. *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_1_2_sig</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:pr-to-ind *)</span>
<span class="sd">(** Exercise 1.3 *)</span>

<span class="sd">(** The propositional uniqueness principles are named with an</span>
<span class="sd">    &#39;eta&#39; postfix in the HoTT library. *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_1_3_prod_lib</span> := @HoTT.Types.Prod.prod_ind.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_1_3_prod</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">prod_ind_eta</span> (<span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>) (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y)) (<span class="nv">x</span> : A * B) : C x :=
    transport C (HoTT.Types.Prod.eta_prod x) (g (fst x) (snd x)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_1_3_prod</span> := prod_ind_eta.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8"><span class="highlight"><span class="kn">Proposition</span> <span class="nf">Book_1_3_prod_refl</span> : <span class="kr">forall</span> <span class="nv">C</span> <span class="nv">g</span> <span class="nv">a</span> <span class="nv">b</span>, prod_ind_eta C g (a, b) = g a b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">prod_ind_eta</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>)
  (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y))
  (<span class="nv">x</span> : A * B) =&gt;
transport C (eta_prod x)
  (g (fst x) (snd x))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y)) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : A * B, C x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>)
(<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y)) (<span class="nv">a</span> : A)
(<span class="nv">b</span> : B), prod_ind_eta C g (a, b) = g a b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">prod_ind_eta</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>)
  (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y))
  (<span class="nv">x</span> : A * B) =&gt;
transport C (eta_prod x)
  (g (fst x) (snd x))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y)) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : A * B, C x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>)
(<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y)) (<span class="nv">a</span> : A)
(<span class="nv">b</span> : B), prod_ind_eta C g (a, b) = g a b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_1_3_prod</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_1_3_sig_lib</span> := @HoTT.Basics.Overture.sig_ind.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_1_3_sig</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">A</span> : <span class="kt">Type</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">B</span> : A -&gt; <span class="kt">Type</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">sig_ind_eta</span> (<span class="nv">C</span> : (<span class="kr">exists</span> (<span class="nv">a</span> : A), B a) -&gt; <span class="kt">Type</span>)
                          (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b))
                          (<span class="nv">x</span> : <span class="kr">exists</span> (<span class="nv">a</span> : A), B a) : C x :=
    transport C (HoTT.Types.Sigma.eta_sigma x) (g (pr1 x) (pr2 x)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_1_3_sig</span> := sig_ind_eta.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka"><span class="highlight"><span class="kn">Proposition</span> <span class="nf">Book_1_3_sig_refl</span> : <span class="kr">forall</span> <span class="nv">C</span> <span class="nv">g</span> <span class="nv">a</span> <span class="nv">b</span>, sig_ind_eta C g (a; b) = g a b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sig_ind_eta</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">C</span> : {a : A &amp; B a} -&gt; <span class="kt">Type</span>)
  (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b))
  (<span class="nv">x</span> : {a : A &amp; B a}) =&gt;
transport C (eta_sigma x) (g x.<span class="mi">1</span> x.<span class="mi">2</span>)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">C</span> : {a : A &amp; B a} -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b)) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : {a : A &amp; B a}, C x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">C</span> : {a : A &amp; B a} -&gt; <span class="kt">Type</span>)
(<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b)) (<span class="nv">a</span> : A)
(<span class="nv">b</span> : (<span class="kr">fun</span> <span class="nv">a0</span> : A =&gt; B a0) a),
sig_ind_eta C g (a; b) = g a b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sig_ind_eta</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">C</span> : {a : A &amp; B a} -&gt; <span class="kt">Type</span>)
  (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b))
  (<span class="nv">x</span> : {a : A &amp; B a}) =&gt;
transport C (eta_sigma x) (g x.<span class="mi">1</span> x.<span class="mi">2</span>)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">C</span> : {a : A &amp; B a} -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b)) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : {a : A &amp; B a}, C x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">C</span> : {a : A &amp; B a} -&gt; <span class="kt">Type</span>)
(<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b)) (<span class="nv">a</span> : A)
(<span class="nv">b</span> : (<span class="kr">fun</span> <span class="nv">a0</span> : A =&gt; B a0) a),
sig_ind_eta C g (a; b) = g a b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_1_3_sig</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:iterator *)</span>
<span class="sd">(** Exercise 1.4 *)</span>



<span class="c">(* ================================================== ex:sum-via-bool *)</span>
<span class="sd">(** Exercise 1.5 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_1_5</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_1_5_sum</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) := { x : Bool &amp; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B }.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;&#39;inl&#39; a&quot;</span> := (true; a) (<span class="kn">at level</span> <span class="mi">0</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;&#39;inr&#39; b&quot;</span> := (false; b) (<span class="kn">at level</span> <span class="mi">0</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_1_5_ind</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">C</span> : Book_1_5_sum A B -&gt; <span class="kt">Type</span>) (<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">a</span>, C (inl a))
   (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">b</span>, C (inr b)) : <span class="kr">forall</span> <span class="nv">x</span> : Book_1_5_sum A B, C x := <span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="kr">match</span> x <span class="kr">with</span>
   | inl a =&gt; f a
   | inr b =&gt; g b
   <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">inl_red</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">C</span> : Book_1_5_sum A B -&gt; <span class="kt">Type</span>} <span class="nv">f</span> <span class="nv">g</span> { <span class="nv">a</span> : A }
  : Book_1_5_ind A B C f g (inl a) = f a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Book_1_5_sum A B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">a</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) true,
C inl (a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">b</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) false,
C inr (b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Book_1_5_ind A B C f g inl (a) = f a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Book_1_5_sum A B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">a</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) true,
C inl (a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">b</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) false,
C inr (b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Book_1_5_ind A B C f g inl (a) = f a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">inr_red</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">C</span> : Book_1_5_sum A B -&gt; <span class="kt">Type</span>} <span class="nv">f</span> <span class="nv">g</span> { <span class="nv">b</span> : B }
  : Book_1_5_ind A B C f g (inr b) = g b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Book_1_5_sum A B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">a</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) true,
C inl (a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">b</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) false,
C inr (b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Book_1_5_ind A B C f g inr (b) = g b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Book_1_5_sum A B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">a</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) true,
C inl (a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">b</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) false,
C inr (b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Book_1_5_ind A B C f g inr (b) = g b</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_1_5</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:prod-via-bool *)</span>
<span class="sd">(** Exercise 1.6 *)</span>



<span class="c">(* ================================================== ex:pm-to-ml *)</span>
<span class="sd">(** Exercise 1.7 *)</span>



<span class="c">(* ================================================== ex:nat-semiring *)</span>
<span class="sd">(** Exercise 1.8 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">rec_nat&#39;</span> (<span class="nv">C</span> : <span class="kt">Type</span>) <span class="nv">c0</span> <span class="nv">cs</span> (<span class="nv">n</span> : nat) : C :=
  <span class="kr">match</span> n <span class="kr">with</span>
    O =&gt; c0
  | S m =&gt; cs m (rec_nat&#39; C c0 cs m)
  <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">add</span> : nat -&gt; nat -&gt; nat :=
  rec_nat&#39; (nat -&gt; nat) (<span class="kr">fun</span> <span class="nv">m</span> =&gt; m) (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">g</span> <span class="nv">m</span> =&gt; (S (g m))).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">mult</span> : nat -&gt; nat -&gt; nat  :=
  rec_nat&#39; (nat -&gt; nat) (<span class="kr">fun</span> <span class="nv">m</span> =&gt; <span class="mi">0</span>) (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">g</span> <span class="nv">m</span> =&gt; add m (g m)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* rec_nat&#39; gives back a function with the wrong argument order, so we flip the</span>
<span class="c">   order of the arguments p and q *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">exp</span> : nat -&gt; nat -&gt; nat  :=
  <span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> =&gt; (rec_nat&#39; (nat -&gt; nat) (<span class="kr">fun</span> <span class="nv">m</span> =&gt; (S <span class="mi">0</span>)) (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">g</span> <span class="nv">m</span> =&gt; mult m (g m))) q p.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10"><span class="highlight"><span class="kn">Example</span> <span class="nf">add_example</span>: add <span class="mi">32</span> <span class="mi">17</span> = <span class="mi">49</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">add <span class="mi">32</span> <span class="mi">17</span> = <span class="mi">49</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">add <span class="mi">32</span> <span class="mi">17</span> = <span class="mi">49</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12"><span class="highlight"><span class="kn">Example</span> <span class="nf">mult_example</span>: mult <span class="mi">20</span> <span class="mi">5</span> = <span class="mi">100</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mult <span class="mi">20</span> <span class="mi">5</span> = <span class="mi">100</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">mult <span class="mi">20</span> <span class="mi">5</span> = <span class="mi">100</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk14"><span class="highlight"><span class="kn">Example</span> <span class="nf">exp_example</span>: exp <span class="mi">2</span> <span class="mi">10</span> = <span class="mi">1024</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">exp <span class="mi">2</span> <span class="mi">10</span> = <span class="mi">1024</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">exp <span class="mi">2</span> <span class="mi">10</span> = <span class="mi">1024</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* To do: proof that these form a semiring *)</span>

<span class="c">(* ================================================== ex:fin *)</span>
<span class="sd">(** Exercise 1.9 *)</span>



<span class="c">(* ================================================== ex:ackermann *)</span>
<span class="sd">(** Exercise 1.10 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">ack</span> (<span class="nv">n</span> <span class="nv">m</span> : nat) : nat :=
  <span class="kr">match</span> n <span class="kr">with</span>
  | O =&gt; S m
  | S p =&gt; <span class="kr">let fix</span> <span class="nv">ackn</span> (<span class="nv">m</span> : nat) :=
               <span class="kr">match</span> m <span class="kr">with</span>
                 | O =&gt; ack p <span class="mi">1</span>
                 | S q =&gt; ack p (ackn q)
               <span class="kr">end</span>
           <span class="kr">in</span> ackn m
  <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_1_10</span> := ack.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:neg-ldn *)</span>
<span class="sd">(** Exercise 1.11 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_1_11</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk16"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">dblneg</span> : <span class="kr">forall</span> <span class="nv">A</span>, (~~~A) -&gt; ~A.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, ~~ ~ A -&gt; ~ A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, ~~ ~ A -&gt; ~ A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18"><span class="highlight"><span class="nb">intros</span> A f a; <span class="nb">apply</span> f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19"><span class="highlight"><span class="nb">intros</span> g; <span class="nb">apply</span> g.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> a.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_1_11</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:tautologies *)</span>
<span class="sd">(** Exercise 1.12 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_1_12</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Book_1_12_part1</span> : <span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span>, A -&gt; (B -&gt; A).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, A -&gt; B -&gt; A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, A -&gt; B -&gt; A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c"><span class="highlight"><span class="nb">intros</span> ? ? a ?.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> a.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1d"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Book_1_12_part2</span> : <span class="kr">forall</span> <span class="nv">A</span>, A -&gt; ~~A.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A -&gt; ~~ A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A -&gt; ~~ A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1f"><span class="highlight"><span class="nb">intros</span> A a f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (f a).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk20"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">Book_1_12_part3</span> : <span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span>, ((~A) + (~B)) -&gt; ~(A * B).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, ~ A + ~ B -&gt; ~ (A * B)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk21"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, ~ A + ~ B -&gt; ~ (A * B)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk22"><span class="highlight"><span class="nb">intros</span> A B [na | nb] [a b].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk23" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk23"><hr></label><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk24"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">na</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (na a).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk25"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (nb b).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_1_12</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:not-not-lem *)</span>
<span class="sd">(** Exercise 1.13 *)</span>



<span class="c">(* ================================================== ex:without-K *)</span>
<span class="sd">(** Exercise 1.14 *)</span>



<span class="c">(* ================================================== ex:subtFromPathInd *)</span>
<span class="sd">(** Exercise 1.15 *)</span>

<span class="c">(* concat_A1p? *)</span>

<span class="c">(* ================================================== ex:add-nat-commutative *)</span>
<span class="sd">(** Exercise 1.16 *)</span>



<span class="c">(* ================================================== ex:basics:concat *)</span>
<span class="sd">(** Exercise 2.1 *)</span>

<span class="c">(* Book_2_1_concatenation1 is equivalent to the proof given in the text *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk26"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation1</span> :
    <span class="kr">forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A}, x = y -&gt; y = z -&gt; x = z.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A), x = y -&gt; y = z -&gt; x = z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk27"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A), x = y -&gt; y = z -&gt; x = z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk28"><span class="highlight"><span class="nb">intros</span> A x y z x_eq_y y_eq_z.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x_eq_y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y_eq_z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">y = z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk29"><span class="highlight"><span class="nb">induction</span> x_eq_y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y_eq_z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2a"><span class="highlight"><span class="nb">induction</span> y_eq_z.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2b"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation2</span> :
    <span class="kr">forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A}, x = y -&gt; y = z -&gt; x = z.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A), x = y -&gt; y = z -&gt; x = z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A), x = y -&gt; y = z -&gt; x = z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2d"><span class="highlight"><span class="nb">intros</span> A x y z x_eq_y y_eq_z.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x_eq_y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y_eq_z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">y = z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2e"><span class="highlight"><span class="nb">induction</span> x_eq_y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y_eq_z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> y_eq_z.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2f"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation3</span> :
    <span class="kr">forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A}, x = y -&gt; y = z -&gt; x = z.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A), x = y -&gt; y = z -&gt; x = z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk30"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A), x = y -&gt; y = z -&gt; x = z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk31"><span class="highlight"><span class="nb">intros</span> A x y z x_eq_y y_eq_z.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x_eq_y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y_eq_z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">y = z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = z</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk32"><span class="highlight"><span class="nb">induction</span> y_eq_z.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x_eq_y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> x_eq_y.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Local Notation</span> <span class="s2">&quot;p *1 q&quot;</span> := (Book_2_1_concatenation1 p q) (<span class="kn">at level</span> <span class="mi">10</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Local Notation</span> <span class="s2">&quot;p *2 q&quot;</span> := (Book_2_1_concatenation2 p q) (<span class="kn">at level</span> <span class="mi">10</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Local Notation</span> <span class="s2">&quot;p *3 q&quot;</span> := (Book_2_1_concatenation3 p q) (<span class="kn">at level</span> <span class="mi">10</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_2_1_Proofs_Are_Equal</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Context</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Variable</span> (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk33"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation1_eq_Book_2_1_concatenation2</span> : p *<span class="mi">1</span> q = p *<span class="mi">2</span> q.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">y = z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p *<span class="mi">1</span> q = p *<span class="mi">2</span> q</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk34"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">y = z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p *<span class="mi">1</span> q = p *<span class="mi">2</span> q</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk35"><span class="highlight"><span class="nb">induction</span> p, q.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> *<span class="mi">1</span> <span class="mi">1</span> = <span class="mi">1</span> *<span class="mi">2</span> <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk36"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation2_eq_Book_2_1_concatenation3</span> : p *<span class="mi">2</span> q =  p *<span class="mi">3</span> q.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">y = z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p *<span class="mi">2</span> q = p *<span class="mi">3</span> q</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk37"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">y = z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p *<span class="mi">2</span> q = p *<span class="mi">3</span> q</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk38"><span class="highlight"><span class="nb">induction</span> p, q.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> *<span class="mi">2</span> <span class="mi">1</span> = <span class="mi">1</span> *<span class="mi">3</span> <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk39"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation1_eq_Book_2_1_concatenation3</span> : p *<span class="mi">1</span> q = p *<span class="mi">3</span> q.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">y = z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p *<span class="mi">1</span> q = p *<span class="mi">3</span> q</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">y = z</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p *<span class="mi">1</span> q = p *<span class="mi">3</span> q</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3b"><span class="highlight"><span class="nb">induction</span> p, q.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> *<span class="mi">1</span> <span class="mi">1</span> = <span class="mi">1</span> *<span class="mi">3</span> <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_2_1_Proofs_Are_Equal</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:eq-proofs-commute *)</span>
<span class="sd">(** Exercise 2.2 *)</span>

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3c"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_2</span> :
  <span class="kr">forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A} (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z),
    (Book_2_1_concatenation1_eq_Book_2_1_concatenation2 p q) *<span class="mi">1</span>
    (Book_2_1_concatenation2_eq_Book_2_1_concatenation3 p q) =
    (Book_2_1_concatenation1_eq_Book_2_1_concatenation3 p q).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A) (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z),
(Book_2_1_concatenation1_eq_Book_2_1_concatenation2 p
   q) *<span class="mi">1</span>
(Book_2_1_concatenation2_eq_Book_2_1_concatenation3 p
   q) =
Book_2_1_concatenation1_eq_Book_2_1_concatenation3 p q</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A) (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z),
(Book_2_1_concatenation1_eq_Book_2_1_concatenation2 p
   q) *<span class="mi">1</span>
(Book_2_1_concatenation2_eq_Book_2_1_concatenation3 p
   q) =
Book_2_1_concatenation1_eq_Book_2_1_concatenation3 p q</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3e"><span class="highlight"><span class="nb">induction</span> p, q.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(Book_2_1_concatenation1_eq_Book_2_1_concatenation2 <span class="mi">1</span>
   <span class="mi">1</span>) *<span class="mi">1</span>
(Book_2_1_concatenation2_eq_Book_2_1_concatenation3 <span class="mi">1</span>
   <span class="mi">1</span>) =
Book_2_1_concatenation1_eq_Book_2_1_concatenation3 <span class="mi">1</span> <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:fourth-concat *)</span>
<span class="sd">(** Exercise 2.3 *)</span>

<span class="c">(* Since we have x_eq_y : x = y we can transport y_eq_z : y = z along</span>
<span class="c">   x_eq_y‚Åª¬π : y = x in the type family Œªw.(w = z) to obtain a term</span>
<span class="c">   of type x = z. *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation4</span>
    {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A} : x = y -&gt; y = z -&gt; x = z :=
  <span class="kr">fun</span> <span class="nv">x_eq_y</span> <span class="nv">y_eq_z</span> =&gt; transport (<span class="kr">fun</span> <span class="nv">w</span> =&gt; w = z) (inverse x_eq_y) y_eq_z.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Local Notation</span> <span class="s2">&quot;p *4 q&quot;</span> := (Book_2_1_concatenation4 p q) (<span class="kn">at level</span> <span class="mi">10</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3f"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation1_eq_Book_2_1_concatenation4</span> :
    <span class="kr">forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A} (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z), (p *<span class="mi">1</span> q = p *<span class="mi">4</span> q).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A) (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z),
p *<span class="mi">1</span> q = p *<span class="mi">4</span> q</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk40"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A) (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z),
p *<span class="mi">1</span> q = p *<span class="mi">4</span> q</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk41"><span class="highlight"><span class="nb">induction</span> p, q.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> *<span class="mi">1</span> <span class="mi">1</span> = <span class="mi">1</span> *<span class="mi">4</span> <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:npaths *)</span>
<span class="sd">(** Exercise 2.4 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_4_npath</span> : nat -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span>
  := nat_ind (<span class="kr">fun</span> (<span class="nv">n</span> : nat) =&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span>)
             <span class="c">(* 0-dimensional paths are elements *)</span>
             (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A)
             <span class="c">(* (n+1)-dimensional paths are paths between n-dimimensional paths *)</span>
             (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">f</span> <span class="nv">A</span> =&gt; (<span class="kr">exists</span> <span class="nv">a1</span> <span class="nv">a2</span> : (f A), a1 = a2)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* This is the intuition behind definition of nboundary:</span>
<span class="c">   As we&#39;ve defined them, every (n+1)-path is a path between two n-paths. *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk42"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">npath_as_sig</span> : <span class="kr">forall</span> {<span class="nv">n</span> : nat} {<span class="nv">A</span> : <span class="kt">Type</span>},
    (Book_2_4_npath (S n) A) = (<span class="kr">exists</span> (<span class="nv">p1</span> <span class="nv">p2</span> : Book_2_4_npath n A), p1 = p2).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">A</span> : <span class="kt">Type</span>),
Book_2_4_npath n.+<span class="mi">1</span> A =
{p1 : Book_2_4_npath n A &amp;
{p2 : Book_2_4_npath n A &amp; p1 = p2}}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk43"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">A</span> : <span class="kt">Type</span>),
Book_2_4_npath n.+<span class="mi">1</span> A =
{p1 : Book_2_4_npath n A &amp;
{p2 : Book_2_4_npath n A &amp; p1 = p2}}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* It can be helpful to take a look at what this definition does.</span>
<span class="c">   Try uncommenting the following lines: *)</span>
<span class="c">(*</span>
<span class="c">Context {A : Type}.</span>
<span class="c">Eval compute in (Book_2_4_npath 0 A). (* = A : Type *)</span>
<span class="c">Eval compute in (Book_2_4_npath 1 A). (* = {a1 : A &amp; {a2 : A &amp; a1 = a2}} : Type *)</span>
<span class="c">Eval compute in (Book_2_4_npath 2 A). (* and so on... *)</span>
<span class="c">*)</span>

<span class="c">(* Given an (n+1)-path, we simply project to a pair of n-paths. *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_4_nboundary</span>
  : <span class="kr">forall</span> {<span class="nv">n</span> : nat} {<span class="nv">A</span> : <span class="kt">Type</span>}, Book_2_4_npath (S n) A -&gt;
                          (Book_2_4_npath n A * Book_2_4_npath n A)
  := <span class="kr">fun</span> {<span class="nv">n</span>} {<span class="nv">A</span>} <span class="nv">p</span> =&gt; (pr1 p, pr1 (pr2 p)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:ap-to-apd-equiv-apd-to-ap *)</span>
<span class="sd">(** Exercise 2.5 *)</span>

<span class="c">(* Note that &quot;@&quot; is notation for concatentation and ^ is for inversion *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_eq_2_3_6</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">p</span> : x = y) (<span class="nv">f</span> : A -&gt; B)
  : (f x = f y) -&gt; (transport (<span class="kr">fun</span> <span class="nv">_</span> =&gt; B) p (f x) = f y) :=
  <span class="kr">fun</span> <span class="nv">fx_eq_fy</span> =&gt;
    (HoTT.Basics.PathGroupoids.transport_const p (f x)) @ fx_eq_fy.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_eq_2_3_7</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">p</span> : x = y) (<span class="nv">f</span> : A -&gt; B)
  : (transport (<span class="kr">fun</span> <span class="nv">_</span> =&gt; B) p (f x) = f y) -&gt; f x = f y :=
  <span class="kr">fun</span> <span class="nv">fx_eq_fy</span> =&gt;
    (HoTT.Basics.PathGroupoids.transport_const p (f x))^ @ fx_eq_fy.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* By induction on p, it suffices to assume that x ‚â° y and p ‚â° refl, so</span>
<span class="c">   the above equations concatenate identity paths, which are units under</span>
<span class="c">   concatenation.</span>

<span class="c">   [isequiv_adjointify] is one way to prove two functions form an equivalence,</span>
<span class="c">   specifically one proves that they are (category-theoretic) sections of one</span>
<span class="c">   another, that is, each is a right inverse for the other. *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk44"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Equivalence_Book_eq_2_3_6_and_Book_eq_2_3_6</span>
           {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">p</span> : x = y) (<span class="nv">f</span> : A -&gt; B)
    : IsEquiv (Book_eq_2_3_6 p f).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (Book_eq_2_3_6 p f)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk45"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (Book_eq_2_3_6 p f)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> (isequiv_adjointify (Book_eq_2_3_6 p f) (Book_eq_2_3_7 p f));
    <span class="nb">unfold</span> Book_eq_2_3_6, Book_eq_2_3_7, transport_const;
    <span class="nb">induction</span> p;
    <span class="nb">intros</span> y;
    <span class="kp">do</span> <span class="mi">2</span> (<span class="nb">rewrite</span> concat_1p);
    <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:equiv-concat *)</span>
<span class="sd">(** Exercise 2.6 *)</span>

<span class="c">(* This exercise is solved in the library as</span>
<span class="c">   HoTT.Types.Paths.isequiv_concat_l</span>
<span class="c"> *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">concat_left</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">z</span> : A) (<span class="nv">p</span> : x = y)
    : (y = z) -&gt; (x = z) :=
  <span class="kr">fun</span> <span class="nv">q</span> =&gt; p @ q.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">concat_right</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">z</span> : A) (<span class="nv">p</span> : x = y)
    : (x = z) -&gt; (y = z) :=
  <span class="kr">fun</span> <span class="nv">q</span> =&gt; (inverse p) @ q.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* Again, by induction on p, it suffices to assume that x ‚â° y and p ‚â° refl, so</span>
<span class="c">   the above equations concatenate identity paths, which are units under</span>
<span class="c">   concatenation. *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk46"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_6</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A} (<span class="nv">p</span> : x = y)
  : IsEquiv (concat_left z p).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (concat_left z p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk47"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y, z</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (concat_left z p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> (isequiv_adjointify (concat_left z p) (concat_right z p));
    <span class="nb">induction</span> p;
    <span class="nb">unfold</span> concat_right, concat_left;
    <span class="nb">intros</span> y;
    <span class="kp">do</span> <span class="mi">2</span> (<span class="nb">rewrite</span> concat_1p);
    <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:ap-sigma *)</span>
<span class="sd">(** Exercise 2.7 *)</span>

<span class="c">(* Already solved as ap_functor_sigma; there is a copy here for completeness *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_2_7</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk48"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_7</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">P</span> : A -&gt; <span class="kt">Type</span>} {<span class="nv">Q</span> : B -&gt; <span class="kt">Type</span>}
            (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">a</span>, P a -&gt; Q (f a))
            (<span class="nv">u</span> <span class="nv">v</span> : sig P) (<span class="nv">p</span> : u.<span class="mi">1</span> = v.<span class="mi">1</span>) (<span class="nv">q</span> : p # u.<span class="mi">2</span> = v.<span class="mi">2</span>)
  : ap (functor_sigma f g) (path_sigma P u v p q)
    = path_sigma Q (functor_sigma f g u) (functor_sigma f g v)
                (ap f p)
                ((transport_compose Q f p (g u.<span class="mi">1</span> u.<span class="mi">2</span>))^
                  @ (@ap_transport _ P (<span class="kr">fun</span> <span class="nv">x</span> =&gt; Q (f x)) _ _ p g u.<span class="mi">2</span>)^
                  @ ap (g v.<span class="mi">1</span>) q).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P a -&gt; Q (f a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u, v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{x : _ &amp; P x}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u.<span class="mi">1</span> = v.<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">transport P p u.<span class="mi">2</span> = v.<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ap (functor_sigma f g) (path_sigma P u v p q) =
path_sigma Q (functor_sigma f g u)
  (functor_sigma f g v) (ap f p)
  (((transport_compose Q f p (g u.<span class="mi">1</span> u.<span class="mi">2</span>))^ @
    (ap_transport p g u.<span class="mi">2</span>)^) @ ap (g v.<span class="mi">1</span>) q)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk49"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P a -&gt; Q (f a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u, v</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{x : _ &amp; P x}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u.<span class="mi">1</span> = v.<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">transport P p u.<span class="mi">2</span> = v.<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ap (functor_sigma f g) (path_sigma P u v p q) =
path_sigma Q (functor_sigma f g u)
  (functor_sigma f g v) (ap f p)
  (((transport_compose Q f p (g u.<span class="mi">1</span> u.<span class="mi">2</span>))^ @
    (ap_transport p g u.<span class="mi">2</span>)^) @ ap (g v.<span class="mi">1</span>) q)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4a"><span class="highlight"><span class="nb">destruct</span> u <span class="kr">as</span> [u1 u2]; <span class="nb">destruct</span> v <span class="kr">as</span> [v1 v2]; <span class="nb">simpl</span> <span class="kr">in</span> p, q.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P a -&gt; Q (f a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P u1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">v2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P v1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u1 = v1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">transport P p u2 = v2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ap (functor_sigma f g)
  (path_sigma P (u1; u2) (v1; v2) p q) =
path_sigma Q (functor_sigma f g (u1; u2))
  (functor_sigma f g (v1; v2)) (ap f p)
  (((transport_compose Q f p (g (u1; u2).<span class="mi">1</span> (u1; u2).<span class="mi">2</span>))^ @
    (ap_transport p g (u1; u2).<span class="mi">2</span>)^) @
   ap (g (v1; v2).<span class="mi">1</span>) q)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4b"><span class="highlight"><span class="nb">destruct</span> p; <span class="nb">simpl</span> <span class="kr">in</span> q.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P a -&gt; Q (f a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u2, v2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P u1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">u2 = v2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ap (functor_sigma f g)
  (path_sigma P (u1; u2) (u1; v2) <span class="mi">1</span> q) =
path_sigma Q (functor_sigma f g (u1; u2))
  (functor_sigma f g (u1; v2)) (ap f <span class="mi">1</span>)
  (((transport_compose Q f <span class="mi">1</span> (g (u1; u2).<span class="mi">1</span> (u1; u2).<span class="mi">2</span>))^ @
    (ap_transport <span class="mi">1</span> g (u1; u2).<span class="mi">2</span>)^) @
   ap (g (u1; v2).<span class="mi">1</span>) q)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4c"><span class="highlight"><span class="nb">destruct</span> q.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P a -&gt; Q (f a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P u1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ap (functor_sigma f g)
  (path_sigma P (u1; u2) (u1; u2) <span class="mi">1</span> <span class="mi">1</span>) =
path_sigma Q (functor_sigma f g (u1; u2))
  (functor_sigma f g (u1; u2)) (ap f <span class="mi">1</span>)
  (((transport_compose Q f <span class="mi">1</span> (g (u1; u2).<span class="mi">1</span> (u1; u2).<span class="mi">2</span>))^ @
    (ap_transport <span class="mi">1</span> g (u1; u2).<span class="mi">2</span>)^) @
   ap (g (u1; u2).<span class="mi">1</span>) <span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_2_7</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:ap-coprod *)</span>
<span class="sd">(** Exercise 2.8 *)</span>



<span class="c">(* ================================================== ex:coprod-ump *)</span>
<span class="sd">(** Exercise 2.9 *)</span>

<span class="c">(* This exercise is solved in the library as</span>
<span class="c">   HoTT.Types.Sum.equiv_sum_ind</span>
<span class="c"> *)</span>
<span class="c">(* To extract a function on either summand, compose with the injections *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">coprod_ump1</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">X</span>} : (A + B -&gt; X) -&gt; (A -&gt; X) * (B -&gt; X) :=
  <span class="kr">fun</span> <span class="nv">f</span> =&gt; (f o inl, f o inr).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* To create a function on the direct sum from functions on the summands, work</span>
<span class="c">   by cases *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4d"><span class="highlight"><span class="kn">Check</span> prod_rect.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">prod_rect
     : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : A * B -&gt; <span class="kt">Type</span>),
       (<span class="kr">forall</span> (<span class="nv">fst</span> : A) (<span class="nv">snd</span> : B), P (fst, snd)) -&gt;
       <span class="kr">forall</span> <span class="nv">p</span> : A * B, P p</span></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">coprod_ump2</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">X</span>} : (A -&gt; X) * (B -&gt; X) -&gt; (A + B -&gt; X) :=
  prod_rect (<span class="kr">fun</span> <span class="nv">_</span> =&gt; A + B -&gt; X) (<span class="kr">fun</span> <span class="nv">f</span> <span class="nv">g</span> =&gt; sum_rect (<span class="kr">fun</span> <span class="nv">_</span> =&gt; X) f g).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4e"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_9</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">X</span>} `{Funext} : (A -&gt; X) * (B -&gt; X) &lt;~&gt; (A + B -&gt; X).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(A -&gt; X) * (B -&gt; X) &lt;~&gt; (A + B -&gt; X)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4f"><span class="highlight"><span class="nb">apply</span> (equiv_adjointify coprod_ump2 coprod_ump1).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : A + B -&gt; X =&gt; coprod_ump2 (coprod_ump1 x)) ==
idmap</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk50" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk50"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : (A -&gt; X) * (B -&gt; X) =&gt;
 coprod_ump1 (coprod_ump2 x)) == idmap</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk51"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : A + B -&gt; X =&gt; coprod_ump2 (coprod_ump1 x)) ==
idmap</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk52" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk52"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : (A -&gt; X) * (B -&gt; X) =&gt;
 coprod_ump1 (coprod_ump2 x)) == idmap</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk53"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : A + B -&gt; X =&gt; coprod_ump2 (coprod_ump1 x)) ==
idmap</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk54"><span class="highlight"><span class="nb">intros</span> f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A + B -&gt; X</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">coprod_ump2 (coprod_ump1 f) = f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk55"><span class="highlight"><span class="nb">apply</span> path_forall.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A + B -&gt; X</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">coprod_ump2 (coprod_ump1 f) == f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">intros</span> [a | b]; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk56"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : (A -&gt; X) * (B -&gt; X) =&gt;
 coprod_ump1 (coprod_ump2 x)) == idmap</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk57"><span class="highlight"><span class="nb">intros</span> [f g].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; X</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">coprod_ump1 (coprod_ump2 (f, g)) = (f, g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:sigma-assoc *)</span>
<span class="sd">(** Exercise 2.10 *)</span>

<span class="c">(* This exercise is solved in the library as</span>
<span class="c">   HoTT.Types.Sigma.equiv_sigma_assoc</span>
<span class="c"> *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">TwoTen</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Context</span> `{A : <span class="kt">Type</span>} {B : A -&gt; <span class="kt">Type</span>} {C : (<span class="kr">exists</span> <span class="nv">a</span> : A, B a) -&gt; <span class="kt">Type</span>}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">f210</span> : (<span class="kr">exists</span> <span class="nv">a</span> : A, (<span class="kr">exists</span> <span class="nv">b</span> : B a, (C (a; b)))) -&gt;
                          (<span class="kr">exists</span> (<span class="nv">p</span> : <span class="kr">exists</span> <span class="nv">a</span> : A, B a), (C p)) :=
    <span class="kr">fun</span> <span class="nv">pairpair</span> =&gt;
      <span class="kr">match</span> pairpair <span class="kr">with</span> (a; pp) =&gt;
        <span class="kr">match</span> pp <span class="kr">with</span> (b; c) =&gt; ((a; b); c) <span class="kr">end</span>
      <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk58"><span class="highlight"><span class="kn">Definition</span> <span class="nf">g210</span> : (<span class="kr">exists</span> (<span class="nv">p</span> : <span class="kr">exists</span> <span class="nv">a</span> : A, B a), (C p)) -&gt;
                          (<span class="kr">exists</span> <span class="nv">a</span> : A, (<span class="kr">exists</span> <span class="nv">b</span> : B a, (C (a; b)))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{p : {a : A &amp; B a} &amp; C p} -&gt;
{a : A &amp; {b : B a &amp; C (a; b)}}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk59"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{p : {a : A &amp; B a} &amp; C p} -&gt;
{a : A &amp; {b : B a &amp; C (a; b)}}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5a"><span class="highlight"><span class="nb">intros</span> pairpair.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pairpair</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{p : {a : A &amp; B a} &amp; C p}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{a : A &amp; {b : B a &amp; C (a; b)}}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5b"><span class="highlight"><span class="nb">induction</span> pairpair <span class="kr">as</span> [pair c].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pair</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{a : A &amp; B a}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C pair</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{a : A &amp; {b : B a &amp; C (a; b)}}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5c"><span class="highlight"><span class="nb">induction</span> pair <span class="kr">as</span> [a b].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C (a; b)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{a : A &amp; {b : B a &amp; C (a; b)}}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (a; (b; c)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5d"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_10</span> : (<span class="kr">exists</span> <span class="nv">a</span> : A, (<span class="kr">exists</span> <span class="nv">b</span> : B a, (C (a; b)))) &lt;~&gt;
                         (<span class="kr">exists</span> (<span class="nv">p</span> : <span class="kr">exists</span> <span class="nv">a</span> : A, B a), (C p)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{a : A &amp; {b : B a &amp; C (a; b)}} &lt;~&gt;
{p : {a : A &amp; B a} &amp; C p}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{a : A &amp; {b : B a &amp; C (a; b)}} &lt;~&gt;
{p : {a : A &amp; B a} &amp; C p}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> (equiv_adjointify f210 g210); <span class="nb">compute</span>; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">TwoTen</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:pullback *)</span>
<span class="sd">(** Exercise 2.11 *)</span>



<span class="c">(* ================================================== ex:pullback-pasting *)</span>
<span class="sd">(** Exercise 2.12 *)</span>



<span class="c">(* ================================================== ex:eqvboolbool *)</span>
<span class="sd">(** Exercise 2.13 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_2_13</span> := @HoTT.Types.Bool.equiv_bool_aut_bool.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:equality-reflection *)</span>
<span class="sd">(** Exercise 2.14 *)</span>



<span class="c">(* ================================================== ex:strengthen-transport-is-ap *)</span>
<span class="sd">(** Exercise 2.15 *)</span>



<span class="c">(* ================================================== ex:strong-from-weak-funext *)</span>
<span class="sd">(** Exercise 2.16 *)</span>



<span class="c">(* ================================================== ex:equiv-functor-types *)</span>
<span class="sd">(** Exercise 2.17 *)</span>



<span class="c">(* ================================================== ex:dep-htpy-natural *)</span>
<span class="sd">(** Exercise 2.18 *)</span>



<span class="c">(* ================================================== ex:equiv-functor-set *)</span>
<span class="sd">(** Exercise 3.1 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_3_1_solution_1</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A &lt;~&gt; B) (<span class="nv">H</span> : IsHSet A)
  := @HoTT.Basics.Trunc.istrunc_equiv_istrunc A B f <span class="mi">0</span> H.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** Alternative solutions: [Book_3_1_solution_2] using UA, and [Book_3_1_solution_3] using two easy lemmas that may be of independent interest *)</span>

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_3_1_solution_2</span> `{Univalence} {A B} : A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk60"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk61"><span class="highlight"><span class="nb">intro</span> e.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A &lt;~&gt; B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet A -&gt; IsHSet B</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk62"><span class="highlight"><span class="nb">rewrite</span> (path_universe_uncurried e).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A &lt;~&gt; B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet B -&gt; IsHSet B</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> idmap.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk63"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">retr_f_g_path_in_B</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A -&gt; B)  (<span class="nv">g</span> : B -&gt; A)
  (<span class="nv">alpha</span> : f o g == idmap) (<span class="nv">x</span> <span class="nv">y</span> : B) (<span class="nv">p</span> : x = y)
  :  p = (alpha x)^ @ (ap f (ap g p)) @ (alpha y).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">alpha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p = ((alpha x)^ @ ap f (ap g p)) @ alpha y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk64"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">alpha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p = ((alpha x)^ @ ap f (ap g p)) @ alpha y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk65"><span class="highlight"><span class="nb">destruct</span> p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">alpha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = ((alpha x)^ @ ap f (ap g <span class="mi">1</span>)) @ alpha x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk66"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">alpha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = ((alpha x)^ @ <span class="mi">1</span>) @ alpha x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk67"><span class="highlight"><span class="nb">rewrite</span> concat_p1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">alpha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = (alpha x)^ @ alpha x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk68"><span class="highlight"><span class="nb">rewrite</span> concat_Vp.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">alpha</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> <span class="mi">1</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk69"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">retr_f_g_isHSet_A_so_B</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A -&gt; B)  (<span class="nv">g</span> : B -&gt; A)
      : f o g == idmap -&gt; IsHSet A -&gt; IsHSet B.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f o g == idmap -&gt; IsHSet A -&gt; IsHSet B</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f o g == idmap -&gt; IsHSet A -&gt; IsHSet B</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6b"><span class="highlight"><span class="nb">intros</span> retr_f_g isHSet_A.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet B</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6c"><span class="highlight">srapply hset_axiomK.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">axiomK B</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6d"><span class="highlight"><span class="nb">unfold</span> axiomK.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : B) (<span class="nv">p</span> : x = x), p = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6e"><span class="highlight"><span class="nb">intros</span> x p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6f"><span class="highlight"><span class="nb">assert</span> (ap g p = <span class="mi">1</span>) <span class="kr">as</span> g_p_is_1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ap g p = <span class="mi">1</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk70" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g_p_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ap g p = <span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk70"><hr></label><div class="goal-conclusion"><span class="highlight">p = <span class="mi">1</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk71"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ap g p = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> (axiomK_hset isHSet_A).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk72"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g_p_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ap g p = <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk73"><span class="highlight"><span class="nb">assert</span> (<span class="mi">1</span> = (retr_f_g x) ^ @ (ap f (ap g p)) @ (retr_f_g x)) <span class="kr">as</span> rhs_is_1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g_p_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ap g p = <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = ((retr_f_g x)^ @ ap f (ap g p)) @ retr_f_g x</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk74" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g_p_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ap g p = <span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rhs_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">1</span> =
((retr_f_g x)^ @ ap f (ap g p)) @
retr_f_g x</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk74"><hr></label><div class="goal-conclusion"><span class="highlight">p = <span class="mi">1</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk75"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g_p_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ap g p = <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = ((retr_f_g x)^ @ ap f (ap g p)) @ retr_f_g x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk76"><span class="highlight"><span class="nb">rewrite</span> g_p_is_1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g_p_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ap g p = <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = ((retr_f_g x)^ @ ap f <span class="mi">1</span>) @ retr_f_g x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk77"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g_p_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ap g p = <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = ((retr_f_g x)^ @ <span class="mi">1</span>) @ retr_f_g x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk78"><span class="highlight"><span class="nb">rewrite</span> concat_p1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g_p_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ap g p = <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = (retr_f_g x)^ @ retr_f_g x</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk79"><span class="highlight"><span class="nb">rewrite</span> concat_Vp.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g_p_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ap g p = <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">1</span> = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> <span class="mi">1</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7a"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g_p_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ap g p = <span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rhs_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">1</span> =
((retr_f_g x)^ @ ap f (ap g p)) @
retr_f_g x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7b"><span class="highlight"><span class="nb">rewrite</span> (rhs_is_1).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f o g == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g_p_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ap g p = <span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rhs_is_1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">1</span> =
((retr_f_g x)^ @ ap f (ap g p)) @
retr_f_g x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p = ((retr_f_g x)^ @ ap f (ap g p)) @ retr_f_g x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> (retr_f_g_path_in_B f g retr_f_g).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_3_1_solution_3</span> {<span class="nv">A</span> <span class="nv">B</span>} : A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7e"><span class="highlight"><span class="nb">intros</span> equivalent_A_B isHSet_A.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">equivalent_A_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A &lt;~&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet B</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7f"><span class="highlight"><span class="nb">elim</span> equivalent_A_B; <span class="nb">intros</span> f isequiv_f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">equivalent_A_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A &lt;~&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isequiv_f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv f</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet B</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk80"><span class="highlight"><span class="nb">elim</span> isequiv_f; <span class="nb">intros</span> g retr_f_g sect_f_g coh.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">equivalent_A_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A &lt;~&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isequiv_f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">retr_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; f (g x)) == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sect_f_g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; g (f x)) == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">coh</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : A, retr_f_g (f x) = ap f (sect_f_g x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet B</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> (retr_f_g_isHSet_A_so_B f g); <span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:isset-coprod *)</span>
<span class="sd">(** Exercise 3.2 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_3_2_solution_1</span> := @HoTT.Types.Sum.ishset_sum.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** Alternative solution for replaying *)</span>

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk81"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_3_2_solution_2</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) : IsHSet A -&gt; IsHSet B -&gt; IsHSet (A+B).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet A -&gt; IsHSet B -&gt; IsHSet (A + B)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk82"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet A -&gt; IsHSet B -&gt; IsHSet (A + B)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk83"><span class="highlight"><span class="nb">intros</span> isHSet_A isHSet_B.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet (A + B)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk84"><span class="highlight">srapply hset_axiomK.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">axiomK (A + B)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk85"><span class="highlight"><span class="nb">unfold</span> axiomK.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : A + B) (<span class="nv">p</span> : x = x), p = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk86"><span class="highlight"><span class="nb">intros</span> x p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A + B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk87"><span class="highlight"><span class="nb">destruct</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">inl a = inl a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p = <span class="mi">1</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk88" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">inr b = inr b</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk88"><hr></label><div class="goal-conclusion"><span class="highlight">p = <span class="mi">1</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk89"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">inl a = inl a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8a"><span class="highlight"><span class="nb">rewrite</span> (inverse (eisretr_path_sum p)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">inl a = inl a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">path_sum (inl a) (inl a) (path_sum_inv p) = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8b"><span class="highlight"><span class="nb">rewrite</span> (axiomK_hset isHSet_A a (path_sum_inv p)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">inl a = inl a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">path_sum (inl a) (inl a) <span class="mi">1</span> = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">simpl</span>; <span class="bp">exact</span> idpath.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8c"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">inr b = inr b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8d"><span class="highlight"><span class="nb">rewrite</span> (inverse (eisretr_path_sum p)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">inr b = inr b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">path_sum (inr b) (inr b) (path_sum_inv p) = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8e"><span class="highlight"><span class="nb">rewrite</span> (axiomK_hset isHSet_B b (path_sum_inv p)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">inr b = inr b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">path_sum (inr b) (inr b) <span class="mi">1</span> = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">simpl</span>; <span class="bp">exact</span> idpath.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:isset-sigma *)</span>
<span class="sd">(** Exercise 3.3 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_3_3_solution_1</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">B</span> : A -&gt; <span class="kt">Type</span>)
   := @HoTT.Types.Sigma.istrunc_sigma A B <span class="mi">0</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** This exercise is hard because 2-paths over Sigma types are not treated in the first three chapters of the book. Consult theories/Types/Sigma.v *)</span>

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_3_3_solution_2</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">B</span> : A -&gt; <span class="kt">Type</span>) :
  IsHSet A -&gt; (<span class="kr">forall</span> <span class="nv">x</span>:A, IsHSet (B x)) -&gt; IsHSet { x:A | B x}.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet A -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : A, IsHSet (B x)) -&gt; IsHSet {x : A &amp; B x}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk90"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet A -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : A, IsHSet (B x)) -&gt; IsHSet {x : A &amp; B x}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk91"><span class="highlight"><span class="nb">intros</span> isHSet_A allBx_HSet.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">allBx_HSet</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : A, IsHSet (B x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet {x : A &amp; B x}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk92"><span class="highlight">srapply hset_axiomK.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">allBx_HSet</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : A, IsHSet (B x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">axiomK {x : A &amp; B x}</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk93"><span class="highlight"><span class="nb">intros</span> x xx.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">allBx_HSet</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : A, IsHSet (B x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{x : A &amp; B x}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">xx = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk94"><span class="highlight"><span class="nb">pose</span> (path_path_sigma B x x xx <span class="mi">1</span>) <span class="kr">as</span> useful.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHSet_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">allBx_HSet</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : A, IsHSet (B x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{x : A &amp; B x}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">xx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">useful</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">path_path_sigma B x x xx <span class="mi">1</span></span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">r</span> : xx ..<span class="mi">1</span> = <span class="mi">1</span> ..<span class="mi">1</span>,
transport
  (<span class="kr">fun</span> <span class="nv">x0</span> : x.<span class="mi">1</span> = x.<span class="mi">1</span> =&gt;
   transport B x0 x.<span class="mi">2</span> = x.<span class="mi">2</span>) r 
  xx ..<span class="mi">2</span> = <span class="mi">1</span> ..<span class="mi">2</span> -&gt; xx = <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">xx = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> (useful (axiomK_hset _ _ _) (hset_path2 _ _)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:prop-endocontr *)</span>
<span class="sd">(** Exercise 3.4 *)</span>

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk95"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_3_4_solution_1</span> `{Funext} (A : <span class="kt">Type</span>) : IsHProp A &lt;-&gt; Contr (A -&gt; A).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp A &lt;-&gt; Contr (A -&gt; A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk96"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp A &lt;-&gt; Contr (A -&gt; A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk97"><span class="highlight"><span class="nb">split</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp A -&gt; Contr (A -&gt; A)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk98" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk98"><hr></label><div class="goal-conclusion"><span class="highlight">Contr (A -&gt; A) -&gt; IsHProp A</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk99"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp A -&gt; Contr (A -&gt; A)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9a"><span class="highlight"><span class="nb">intro</span> isHProp_A.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Contr (A -&gt; A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9b"><span class="highlight"><span class="kr">exists</span> <span class="nv">idmap</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : A -&gt; A, idmap = y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> path_ishprop. <span class="c">(* automagically, from IsHProp A *)</span></span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9c"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Contr (A -&gt; A) -&gt; IsHProp A</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9d"><span class="highlight"><span class="nb">intro</span> contr_AA.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">contr_AA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Contr (A -&gt; A)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9e"><span class="highlight"><span class="nb">apply</span> hprop_allpath; <span class="nb">intros</span> a1 a2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">contr_AA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Contr (A -&gt; A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a1, a2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a1 = a2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (ap10 (path_contr (<span class="kr">fun</span> <span class="nv">x</span>:A =&gt; a1) (<span class="kr">fun</span> <span class="nv">x</span>:A =&gt; a2)) a1).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:prop-inhabcontr *)</span>
<span class="sd">(** Exercise 3.5 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_3_5_solution_1</span> := @HoTT.HProp.equiv_hprop_inhabited_contr.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:lem-mereprop *)</span>
<span class="sd">(** Exercise 3.6 *)</span>

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_3_6_solution_1</span> `{Funext} (A : <span class="kt">Type</span>) : IsHProp A -&gt; IsHProp (A + ~A).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp A -&gt; IsHProp (A + ~ A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp A -&gt; IsHProp (A + ~ A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka1"><span class="highlight"><span class="nb">intro</span> isHProp_A.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp (A + ~ A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka2"><span class="highlight"><span class="nb">apply</span> hprop_allpath.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : A + ~ A, x = y</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka3"><span class="highlight"><span class="nb">intros</span> x y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A + ~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka4"><span class="highlight"><span class="nb">destruct</span> x <span class="kr">as</span> [a1|n1]; <span class="nb">destruct</span> y <span class="kr">as</span> [a2|n2]; <span class="nb">apply</span> path_sum; <span class="kp">try</span> <span class="nb">apply</span> path_ishprop.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chka5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chka5"><hr></label><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka6"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (n2 a1).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka7"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (n1 a2).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:disjoint-or *)</span>
<span class="sd">(** Exercise 3.7 *)</span>

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_3_7_solution_1</span> (<span class="nv">A</span> <span class="nv">B</span>: <span class="kt">Type</span>) :
  IsHProp A -&gt; IsHProp B -&gt; ~(A*B) -&gt; IsHProp (A+B).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp A -&gt; IsHProp B -&gt; ~ (A * B) -&gt; IsHProp (A + B)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp A -&gt; IsHProp B -&gt; ~ (A * B) -&gt; IsHProp (A + B)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkaa"><span class="highlight"><span class="nb">intros</span> isHProp_A isProp_B nab.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isProp_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nab</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ (A * B)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp (A + B)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkab"><span class="highlight"><span class="nb">apply</span> hprop_allpath.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isProp_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nab</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ (A * B)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : A + B, x = y</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkac"><span class="highlight"><span class="nb">intros</span> x y.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isProp_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nab</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ (A * B)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A + B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkad"><span class="highlight"><span class="nb">destruct</span> x <span class="kr">as</span> [a1|b1]; <span class="nb">destruct</span> y <span class="kr">as</span> [a2|b2]; <span class="nb">apply</span> path_sum; <span class="kp">try</span> <span class="nb">apply</span> path_ishprop.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isProp_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nab</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ (A * B)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkae" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isProp_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nab</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ (A * B)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chkae"><hr></label><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkaf"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isProp_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nab</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ (A * B)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (nab (a1,b2)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb0"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isHProp_A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">isProp_B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nab</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ (A * B)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (nab (a2,b1)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:brck-qinv *)</span>
<span class="sd">(** Exercise 3.8 *)</span>



<span class="c">(* ================================================== ex:lem-impl-prop-equiv-bool *)</span>
<span class="sd">(** Exercise 3.9 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">LEM</span> := <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>), IsHProp A -&gt; A + ~A.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">LEM_hProp_Bool</span> (<span class="nv">lem</span> : LEM) (<span class="nv">hprop</span> : HProp) : Bool
  := <span class="kr">match</span> (lem hprop _) <span class="kr">with</span> inl _ =&gt; true | inr _ =&gt; false <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_3_9_solution_1</span> `{Univalence} : LEM -&gt; HProp &lt;~&gt; Bool.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LEM -&gt; HProp &lt;~&gt; Bool</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LEM -&gt; HProp &lt;~&gt; Bool</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb3"><span class="highlight"><span class="nb">intro</span> lem.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">HProp &lt;~&gt; Bool</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb4"><span class="highlight"><span class="nb">apply</span> (equiv_adjointify (LEM_hProp_Bool lem) is_true).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; LEM_hProp_Bool lem (is_true x)) ==
idmap</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkb5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chkb5"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : HProp =&gt; is_true (LEM_hProp_Bool lem x)) ==
idmap</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb6"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; LEM_hProp_Bool lem (is_true x)) ==
idmap</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb7"><span class="highlight"><span class="nb">intros</span> []; <span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LEM_hProp_Bool lem Unit_hp = true</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkb8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chkb8"><hr></label><div class="goal-conclusion"><span class="highlight">LEM_hProp_Bool lem False_hp = false</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb9"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LEM_hProp_Bool lem Unit_hp = true</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkba"><span class="highlight"><span class="nb">unfold</span> LEM_hProp_Bool.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> lem Unit_hp (trunctype_istrunc Unit_hp) <span class="kr">with</span>
| inl _ =&gt; true
| inr _ =&gt; false
<span class="kr">end</span> = true</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkbb"><span class="highlight"><span class="nb">elim</span> (lem Unit_hp _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Unit_hp -&gt; true = true</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkbc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chkbc"><hr></label><div class="goal-conclusion"><span class="highlight">~ Unit_hp -&gt; false = true</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkbd"><span class="highlight">*</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Unit_hp -&gt; true = true</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">_</span> =&gt; <span class="mi">1</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkbe"><span class="highlight">*</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ Unit_hp -&gt; false = true</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkbf"><span class="highlight"><span class="nb">intro</span> nUnit.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nUnit</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ Unit_hp</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">false = true</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">elim</span> (nUnit tt).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc0"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">LEM_hProp_Bool lem False_hp = false</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc1"><span class="highlight"><span class="nb">unfold</span> LEM_hProp_Bool.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span> lem False_hp (trunctype_istrunc False_hp) <span class="kr">with</span>
| inl _ =&gt; true
| inr _ =&gt; false
<span class="kr">end</span> = false</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc2"><span class="highlight"><span class="nb">elim</span> (lem False_hp _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">False_hp -&gt; true = false</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkc3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chkc3"><hr></label><div class="goal-conclusion"><span class="highlight">~ False_hp -&gt; false = false</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc4"><span class="highlight">*</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">False_hp -&gt; true = false</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc5"><span class="highlight"><span class="nb">intro</span> fals.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fals</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">False_hp</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">true = false</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">elim</span> fals.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc6"><span class="highlight">*</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ False_hp -&gt; false = false</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">_</span> =&gt; <span class="mi">1</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc7"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : HProp =&gt; is_true (LEM_hProp_Bool lem x)) ==
idmap</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc8"><span class="highlight"><span class="nb">intro</span> hprop.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">hprop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HProp</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">is_true (LEM_hProp_Bool lem hprop) = hprop</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc9"><span class="highlight"><span class="nb">unfold</span> LEM_hProp_Bool.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">hprop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HProp</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">is_true
  <span class="kr">match</span> lem hprop (trunctype_istrunc hprop) <span class="kr">with</span>
  | inl _ =&gt; true
  | inr _ =&gt; false
  <span class="kr">end</span> = hprop</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkca"><span class="highlight"><span class="nb">elim</span> (lem hprop _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">hprop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HProp</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">hprop -&gt; is_true true = hprop</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkcb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">hprop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HProp</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chkcb"><hr></label><div class="goal-conclusion"><span class="highlight">~ hprop -&gt; is_true false = hprop</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkcc"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">hprop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HProp</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">hprop -&gt; is_true true = hprop</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkcd"><span class="highlight"><span class="nb">intro</span> p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">hprop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HProp</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hprop</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">is_true true = hprop</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkce"><span class="highlight"><span class="nb">apply</span> path_hprop; <span class="nb">simpl</span>. <span class="c">(* path_prop is silent *)</span></span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">hprop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HProp</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hprop</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Unit &lt;~&gt; hprop</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> ((if_hprop_then_equiv_Unit hprop p)^-<span class="mi">1</span>)%equiv.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkcf"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">hprop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HProp</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ hprop -&gt; is_true false = hprop</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd0"><span class="highlight"><span class="nb">intro</span> np.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">hprop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HProp</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">np</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ hprop</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">is_true false = hprop</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd1"><span class="highlight"><span class="nb">apply</span> path_hprop; <span class="nb">simpl</span>. <span class="c">(* path_prop is silent *)</span></span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lem</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">LEM</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">hprop</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">HProp</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">np</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ hprop</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty &lt;~&gt; hprop</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> ((if_not_hprop_then_equiv_Empty hprop np)^-<span class="mi">1</span>)%equiv.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:lem-impred *)</span>
<span class="sd">(** Exercise 3.10 *)</span>



<span class="c">(* ================================================== ex:not-brck-A-impl-A *)</span>
<span class="sd">(** Exercise 3.11 *)</span>

<span class="sd">(** This theorem extracts the main idea leading to the contradiction constructed</span>
<span class="sd">    in the proof of Theorem 3.2.2, that univalence implies that all functions are</span>
<span class="sd">    natural with respect to equivalences.</span>

<span class="sd">    The terms are complicated, but it pretty much follows the proof in the book,</span>
<span class="sd">    step by step.</span>
<span class="sd"> *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">univalence_func_natural_equiv</span> `{Univalence}
  : <span class="kr">forall</span> (<span class="nv">C</span> : <span class="kt">Type</span> -&gt; <span class="kt">Type</span>) (<span class="nv">all_contr</span> : <span class="kr">forall</span> <span class="nv">A</span>, Contr (C A -&gt; C A))
      (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">A</span>, C A -&gt; A) {<span class="nv">A</span> : <span class="kt">Type</span>}  (<span class="nv">e</span> : A &lt;~&gt; A),
    e o (g A) = (g A).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span> -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)) -&gt;
<span class="kr">forall</span> (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A) (<span class="nv">A</span> : <span class="kt">Type</span>)
(<span class="nv">e</span> : A &lt;~&gt; A), e o g A = g A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span> -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)) -&gt;
<span class="kr">forall</span> (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A) (<span class="nv">A</span> : <span class="kt">Type</span>)
(<span class="nv">e</span> : A &lt;~&gt; A), e o g A = g A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd4"><span class="highlight"><span class="nb">intros</span> C all_contr g A e.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">all_contr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A &lt;~&gt; A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">e o g A = g A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd5"><span class="highlight"><span class="nb">apply</span> path_forall.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">all_contr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A &lt;~&gt; A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : C A =&gt; e (g A x)) == g A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd6"><span class="highlight"><span class="nb">intros</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">all_contr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A &lt;~&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">e (g A x) = g A x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd7"><span class="highlight"><span class="nb">pose</span> (p := path_universe_uncurried e).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">all_contr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A &lt;~&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">path_universe_uncurried e</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A = A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">e (g A x) = g A x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="c">(* The propositional computation rule for univalence of section 2.10 *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd8"><span class="highlight"><span class="nb">refine</span> (concat (happly (transport_idmap_path_universe_uncurried e)^ (g A x)) _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">all_contr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A &lt;~&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">path_universe_uncurried e</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A = A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">transport idmap (path_universe_uncurried e) (g A x) =
g A x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="sd">(** To obtain the situation of 2.9.4, we rewrite x using</span>

<span class="sd">      &lt;&lt;&lt;</span>
<span class="sd">        x = transport (fun A : Type =&gt; C A) p^ x</span>
<span class="sd">      &gt;&gt;&gt;</span>

<span class="sd">      This equality holds because [(C A) -&gt; (C A)] is contractible, so</span>

<span class="sd">      &lt;&lt;&lt;</span>
<span class="sd">        transport (fun A : Type =&gt; C A) p^ = idmap</span>
<span class="sd">      &gt;&gt;&gt;</span>

<span class="sd">      In both Theorem 3.2.2 and the following result, the hypothesis</span>
<span class="sd">      [Contr ((C A) -&gt; (C A))] will follow from the contractibility of [(C A)].</span>
<span class="sd">   *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd9"><span class="highlight"><span class="nb">refine</span> (concat (ap _ (ap _ (happly (@path_contr _ (all_contr A)
                                                  idmap (transport _ p^)) x))) _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">all_contr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A &lt;~&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">path_universe_uncurried e</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A = A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">transport idmap (path_universe_uncurried e)
  (g A (transport C p^ x)) = g A x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="c">(* Equation 2.9.4 is called transport_arrow in the library. *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkda"><span class="highlight"><span class="nb">refine</span> (concat (@transport_arrow _ (<span class="kr">fun</span> <span class="nv">A</span> =&gt; C A) idmap _ _ p (g A) x)^ _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">all_contr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A &lt;~&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">path_universe_uncurried e</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A = A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">transport (<span class="kr">fun</span> <span class="nv">x</span> : <span class="kt">Type</span> =&gt; C x -&gt; x) p (g A) x = g A x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (happly (apD g p) x).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** For this proof, we closely follow the proof of Theorem 3.2.2</span>
<span class="sd">    from the text, replacing ¬¨¬¨A ‚Üí A by ‚à•A‚à• ‚Üí A. *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkdb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_3_11</span> `{Univalence} : ~ (<span class="kr">forall</span> <span class="nv">A</span>, Trunc (-<span class="mi">1</span>) A -&gt; A).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ (<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkdc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ (<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  <span class="c">(* The proof is by contradiction. We&#39;ll assume we have such a</span>
<span class="c">     function, and obtain an element of 0. *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkdd"><span class="highlight"><span class="nb">intros</span> g.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkde"><span class="highlight"><span class="nb">assert</span> (end_contr : <span class="kr">forall</span> <span class="nv">A</span>, Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkdf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">end_contr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chkdf"><hr></label><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke0"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke1"><span class="highlight"><span class="nb">intros</span> A.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke2"><span class="highlight"><span class="nb">apply</span> Book_3_4_solution_1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp (Trunc (-<span class="mi">1</span>) A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> Trunc_is_trunc.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke3"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">end_contr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="sd">(** There are no fixpoints of the fix-point free autoequivalence of 2 (called</span>
<span class="sd">      negb). We will derive a contradiction by showing there must be such a fixpoint</span>
<span class="sd">      by naturality of g.</span>

<span class="sd">      We parametrize over b to emphasize that this proof depends only on the fact</span>
<span class="sd">      that Bool is inhabited, not on any specific value (we use &quot;true&quot; below).</span>
<span class="sd">   *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke4"><span class="highlight"><span class="nb">pose</span>
    (contr b :=
        (not_fixed_negb (g Bool b))
        (happly (univalence_func_natural_equiv _ end_contr g equiv_negb) b)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">end_contr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">contr</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">b</span> : Trunc (-<span class="mi">1</span>) Bool =&gt;
not_fixed_negb (g Bool b)
  (ap10
     (univalence_func_natural_equiv
        (Trunc (-<span class="mi">1</span>)) end_contr g equiv_negb) b)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Trunc (-<span class="mi">1</span>) Bool -&gt; Empty</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">contradiction</span> (contr (tr true)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:lem-impl-simple-ac *)</span>
<span class="sd">(** Exercise 3.12 *)</span>



<span class="c">(* ================================================== ex:naive-lem-impl-ac *)</span>
<span class="sd">(** Exercise 3.13 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_3_13</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">naive_LEM_impl_DN_elim</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">LEM</span> : A + ~A)
  : ~~A -&gt; A
    := <span class="kr">fun</span> <span class="nv">nna</span> =&gt; <span class="kr">match</span> LEM <span class="kr">with</span>
                    | inl a =&gt; a
                    | inr na =&gt; <span class="kr">match</span> nna na <span class="kr">with</span> <span class="kr">end</span>
                  <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">naive_LEM_implies_AC</span>
  : (<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~A)
    -&gt; <span class="kr">forall</span> <span class="nv">X</span> <span class="nv">A</span> <span class="nv">P</span>,
         (<span class="kr">forall</span> <span class="nv">x</span> : X, ~~{ a : A x | P x a })
         -&gt; { g : <span class="kr">forall</span> <span class="nv">x</span>, A x | <span class="kr">forall</span> <span class="nv">x</span>, P x (g x) }.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A) -&gt;
<span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">A</span> : X -&gt; <span class="kt">Type</span>)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">x</span> : X, ~~ {a : A x &amp; P x a}) -&gt;
{g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A) -&gt;
<span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">A</span> : X -&gt; <span class="kt">Type</span>)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">x</span> : X, ~~ {a : A x &amp; P x a}) -&gt;
{g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke7"><span class="highlight"><span class="nb">intros</span> LEM X A P H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ {a : A x &amp; P x a}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke8"><span class="highlight"><span class="nb">pose</span> (<span class="kr">fun</span> <span class="nv">x</span> =&gt; @naive_LEM_impl_DN_elim _ (LEM _) (H x)) <span class="kr">as</span> H&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ {a : A x &amp; P x a}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : X =&gt;
naive_LEM_impl_DN_elim {a : A x &amp; P x a}
  (LEM {a : A x &amp; P x a}) (H x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, {a : A x &amp; P x a}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke9"><span class="highlight"><span class="kr">exists</span> (<span class="nv">fun</span> <span class="nv">x</span> =&gt; (H&#39; x).<span class="mi">1</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ {a : A x &amp; P x a}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : X =&gt;
naive_LEM_impl_DN_elim {a : A x &amp; P x a}
  (LEM {a : A x &amp; P x a}) (H x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, {a : A x &amp; P x a}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, P x (H&#39; x).<span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span> =&gt; (H&#39; x).<span class="mi">2</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkea"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_3_13</span> `{Funext}
  : (<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~A)
    -&gt; <span class="kr">forall</span> <span class="nv">X</span> <span class="nv">A</span> <span class="nv">P</span>,
         IsHSet X
         -&gt; (<span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x))
         -&gt; (<span class="kr">forall</span> <span class="nv">x</span> (<span class="nv">a</span> : A x), IsHProp (P x a))
         -&gt; (<span class="kr">forall</span> <span class="nv">x</span>, merely { a : A x &amp; P x a })
         -&gt; merely { g : <span class="kr">forall</span> <span class="nv">x</span>, A x &amp; <span class="kr">forall</span> <span class="nv">x</span>, P x (g x) }.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A) -&gt;
<span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">A</span> : X -&gt; <span class="kt">Type</span>)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span>),
IsHSet X -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)) -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)) -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : X, merely {a : A x &amp; P x a}) -&gt;
merely
  {g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkeb"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A) -&gt;
<span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">A</span> : X -&gt; <span class="kt">Type</span>)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span>),
IsHSet X -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)) -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)) -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : X, merely {a : A x &amp; P x a}) -&gt;
merely
  {g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkec"><span class="highlight"><span class="nb">intros</span> LEM X A P HX HA HP H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HX</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, merely {a : A x &amp; P x a}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">merely
  {g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chked"><span class="highlight"><span class="nb">apply</span> tr.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HX</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, merely {a : A x &amp; P x a}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkee"><span class="highlight"><span class="nb">apply</span> (naive_LEM_implies_AC LEM).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HX</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, merely {a : A x &amp; P x a}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ {a : A x &amp; P x a}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkef"><span class="highlight"><span class="nb">intro</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HX</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, merely {a : A x &amp; P x a}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ {a : A x &amp; P x a}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf0"><span class="highlight"><span class="nb">specialize</span> (H0 x).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HX</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">merely {a : A x &amp; P x a}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ {a : A x &amp; P x a}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf1"><span class="highlight"><span class="nb">revert</span> H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HX</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">merely {a : A x &amp; P x a} -&gt; ~~ {a : A x &amp; P x a}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf2"><span class="highlight"><span class="nb">apply</span> Trunc_rec.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HX</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHSet X</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{a : A x &amp; P x a} -&gt; ~~ {a : A x &amp; P x a}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">nx</span> =&gt; nx x).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_3_13</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:lem-brck *)</span>
<span class="sd">(** Exercise 3.14 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_3_14</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Context</span> `{Funext}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hypothesis</span> <span class="nv">LEM</span> : <span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~A.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf3"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_3_14</span>
  : <span class="kr">forall</span> <span class="nv">A</span> (<span class="nv">P</span> : ~~A -&gt; <span class="kt">Type</span>),
    (<span class="kr">forall</span> <span class="nv">a</span>, P (<span class="kr">fun</span> <span class="nv">na</span> =&gt; na a))
    -&gt; (<span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> (<span class="nv">z</span> : P x) (<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w)
    -&gt; <span class="kr">forall</span> <span class="nv">x</span>, P x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : ~~ A -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)) -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) (<span class="nv">w</span> : P y),
 transport P (path_ishprop x y) z = w) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : ~~ A, P x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : ~~ A -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)) -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) (<span class="nv">w</span> : P y),
 transport P (path_ishprop x y) z = w) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : ~~ A, P x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf5"><span class="highlight"><span class="nb">intros</span> A P base p nna.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P nna</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf6"><span class="highlight"><span class="nb">assert</span> (<span class="kr">forall</span> <span class="nv">x</span>, IsHProp (P x)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkf7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chkf7"><hr></label><div class="goal-conclusion"><span class="highlight">P nna</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf8"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf9"><span class="highlight"><span class="nb">intro</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna, x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp (P x)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkfa"><span class="highlight"><span class="nb">apply</span> hprop_allpath.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna, x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x0</span> <span class="nv">y</span> : P x, x0 = y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkfb"><span class="highlight"><span class="nb">intros</span> x&#39; y&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna, x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x', y'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x&#39; = y&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkfc"><span class="highlight"><span class="nb">etransitivity</span>; [ <span class="nb">symmetry</span>; <span class="nb">apply</span> (p x x y&#39; x&#39;) | ].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna, x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x', y'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">transport P (path_ishprop x x) y&#39; = y&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">     <span class="c">(* Without this it somehow proves [H&#39;] using the wrong universe for hprop_Empty and fails when we do [Defined].</span>
<span class="c">        See Coq #4862. *)</span>
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkfd"><span class="highlight"><span class="nb">set</span> (path := path_ishprop x x).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna, x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x', y'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">path</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">path_ishprop x x</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">transport P path y&#39; = y&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkfe"><span class="highlight"><span class="nb">assert</span> (H&#39; : idpath = path) <span class="bp">by</span> <span class="nb">apply</span> path_ishprop.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna, x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x', y'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">path</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">path_ishprop x x</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = x</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">1</span> = path</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">transport P path y&#39; = y&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkff"><span class="highlight"><span class="nb">destruct</span> H&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna, x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x', y'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P x</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">transport P <span class="mi">1</span> y&#39; = y&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk100"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P nna</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk101"><span class="highlight"><span class="nb">destruct</span> (LEM (P nna) _) <span class="kr">as</span> [pnna|npnna]; <span class="nb">trivial</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npnna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ P nna</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P nna</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk102"><span class="highlight"><span class="nb">refine</span> (<span class="kr">match</span> _ : Empty <span class="kr">with</span> <span class="kr">end</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npnna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ P nna</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk103"><span class="highlight"><span class="nb">apply</span> nna.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npnna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ P nna</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk104"><span class="highlight"><span class="nb">intro</span> a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npnna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ P nna</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk105"><span class="highlight"><span class="nb">apply</span> npnna.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">base</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">npnna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ P nna</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P nna</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (transport P (path_ishprop _ _) (base a)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk106"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_3_14_equiv</span> <span class="nv">A</span> : merely A &lt;~&gt; ~~A.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">merely A &lt;~&gt; ~~ A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk107"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">merely A &lt;~&gt; ~~ A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk108"><span class="highlight"><span class="nb">apply</span> equiv_iff_hprop.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">merely A -&gt; ~~ A</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk109" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk109"><hr></label><div class="goal-conclusion"><span class="highlight">~~ A -&gt; merely A</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">merely A -&gt; ~~ A</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10b"><span class="highlight"><span class="nb">apply</span> Trunc_rec.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">A -&gt; ~~ A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">na</span> =&gt; na a).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10c"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ A -&gt; merely A</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10d"><span class="highlight"><span class="nb">intro</span> nna.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">merely A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10e"><span class="highlight"><span class="nb">apply</span> (@Book_3_14 A (<span class="kr">fun</span> <span class="nv">_</span> =&gt; merely A)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">A -&gt; merely A</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk10f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk10f"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> <span class="nv">w</span> : merely A),
transport (<span class="kr">fun</span> <span class="nv">_</span> : ~~ A =&gt; merely A)
  (path_ishprop x y) z = w</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk110" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk110"><hr></label><div class="goal-conclusion"><span class="highlight">~~ A</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk111"><span class="highlight">*</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">A -&gt; merely A</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> tr.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk112"><span class="highlight">*</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> <span class="nv">w</span> : merely A),
transport (<span class="kr">fun</span> <span class="nv">_</span> : ~~ A =&gt; merely A)
  (path_ishprop x y) z = w</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk113"><span class="highlight"><span class="nb">intros</span> x y z w.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna, x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">z, w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">merely A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">transport (<span class="kr">fun</span> <span class="nv">_</span> : ~~ A =&gt; merely A)
  (path_ishprop x y) z = w</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> path_ishprop.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk114"><span class="highlight">*</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nna</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ A</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> nna.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_3_14</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:impred-brck *)</span>
<span class="sd">(** Exercise 3.15 *)</span>



<span class="c">(* ================================================== ex:lem-impl-dn-commutes *)</span>
<span class="sd">(** Exercise 3.16 *)</span>



<span class="c">(* ================================================== ex:prop-trunc-ind *)</span>
<span class="sd">(** Exercise 3.17 *)</span>



<span class="c">(* ================================================== ex:lem-ldn *)</span>
<span class="sd">(** Exercise 3.18 *)</span>



<span class="c">(* ================================================== ex:decidable-choice *)</span>
<span class="sd">(** Exercise 3.19 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_3_19</span> := @HoTT.BoundedSearch.minimal_n.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:omit-contr2 *)</span>
<span class="sd">(** Exercise 3.20 *)</span>



<span class="c">(* ================================================== ex:isprop-equiv-equiv-bracket *)</span>
<span class="sd">(** Exercise 3.21 *)</span>



<span class="c">(* ================================================== ex:finite-choice *)</span>
<span class="sd">(** Exercise 3.22 *)</span>



<span class="c">(* ================================================== ex:decidable-choice-strong *)</span>
<span class="sd">(** Exercise 3.23 *)</span>



<span class="c">(* ================================================== ex:two-sided-adjoint-equivalences *)</span>
<span class="sd">(** Exercise 4.1 *)</span>



<span class="c">(* ================================================== ex:symmetric-equiv *)</span>
<span class="sd">(** Exercise 4.2 *)</span>



<span class="c">(* ================================================== ex:qinv-autohtpy-no-univalence *)</span>
<span class="sd">(** Exercise 4.3 *)</span>



<span class="c">(* ================================================== ex:unstable-octahedron *)</span>
<span class="sd">(** Exercise 4.4 *)</span>



<span class="c">(* ================================================== ex:2-out-of-6 *)</span>
<span class="sd">(** Exercise 4.5 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_4_5</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">parts</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Variables</span> <span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">f</span> : A -&gt; B.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">g</span> : B -&gt; C.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Variable</span> <span class="nv">h</span> : C -&gt; D.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Context</span> `{IsEquiv _ _ (g o f), IsEquiv _ _ (h o g)}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk115"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Book_4_5_g</span> : IsEquiv g.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv g</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk116"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv g</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk117"><span class="highlight"><span class="nb">apply</span> isequiv_biinv.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">BiInv g</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk118"><span class="highlight"><span class="nb">split</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{g0 : C -&gt; B &amp; (<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; g0 (g x)) == idmap}</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk119" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk119"><hr></label><div class="goal-conclusion"><span class="highlight">{h : C -&gt; B &amp; (<span class="kr">fun</span> <span class="nv">x</span> : C =&gt; g (h x)) == idmap}</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{g0 : C -&gt; B &amp; (<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; g0 (g x)) == idmap}</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kr">exists</span> ((h o g)^-<span class="mi">1</span> o h);
        <span class="kp">repeat</span> <span class="nb">intro</span>; <span class="nb">simpl</span>;
        <span class="kp">try</span> <span class="nb">apply</span> (@eissect _ _ (h o g)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11b"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{h : C -&gt; B &amp; (<span class="kr">fun</span> <span class="nv">x</span> : C =&gt; g (h x)) == idmap}</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kr">exists</span> (<span class="nv">f</span> <span class="nv">o</span> (g o f)^-<span class="mi">1</span>);
        <span class="kp">repeat</span> <span class="nb">intro</span>; <span class="nb">simpl</span>;
        <span class="kp">try</span> <span class="nb">apply</span> (@eisretr _ _ (g o f)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11c"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Book_4_5_f</span> : IsEquiv f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11e"><span class="highlight"><span class="nb">apply</span> (isequiv_homotopic (g^-<span class="mi">1</span> o (g o f))); <span class="kp">try</span> <span class="bp">exact</span> _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; g^-<span class="mi">1</span> (g (f x))) == f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">intro</span>; <span class="nb">apply</span> (eissect g).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11f"><span class="highlight"><span class="kn">Instance</span> <span class="nf">Book_4_5_h</span> : IsEquiv h.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv h</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk120"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv h</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk121"><span class="highlight"><span class="nb">apply</span> (isequiv_homotopic ((h o g) o g^-<span class="mi">1</span>)); <span class="kp">try</span> <span class="bp">exact</span> _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : C =&gt; h (g (g^-<span class="mi">1</span> x))) == h</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">intro</span>; <span class="nb">apply</span> (ap h); <span class="nb">apply</span> (eisretr g).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk122"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_4_5_hgf</span> : IsEquiv (h o g o f).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (h o g o f)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk123"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B, C, D</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; C</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">C -&gt; D</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (g o f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (h o g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (h o g o f)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">typeclasses eauto</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">parts</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="c">(*Lemma Book_4_5 A B f `{IsEquiv A B f} (a a&#39; : A) : IsEquiv (@ap _ _ f a a&#39;).</span>
<span class="c">  Proof.</span>
<span class="c">    pose (@ap _ _ (f^-1) (f a) (f a&#39;)) as f&#39;.</span>
<span class="c">    pose (fun p : f^-1 (f a) = _ =&gt; p @ (@eissect _ _ f _ a&#39;)) as g&#39;.</span>
<span class="c">    pose (fun p : _ = a&#39; =&gt; (@eissect _ _ f _ a)^ @ p) as h&#39;.</span>
<span class="c">    pose (g&#39; o f&#39;).</span>
<span class="c">    pose (h&#39; o g&#39;).</span>
<span class="c">    admit.</span>
<span class="c">  Qed.*)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_4_5</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:qinv-univalence *)</span>
<span class="sd">(** Exercise 4.6 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_4_6_i</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">is_qinv</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A -&gt; B)
    := { g : B -&gt; A &amp; ((f o g == idmap) * (g o f == idmap))%type }.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">qinv</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
    := { f : A -&gt; B &amp; is_qinv f }.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">qinv_id</span> <span class="nv">A</span> : qinv A A
    := (<span class="kr">fun</span> <span class="nv">x</span> =&gt; x; (<span class="kr">fun</span> <span class="nv">x</span> =&gt; x ; (<span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="mi">1</span>, <span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="mi">1</span>))).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">qinv_path</span> <span class="nv">A</span> <span class="nv">B</span> : (A = B) -&gt; qinv A B
    := <span class="kr">fun</span> <span class="nv">p</span> =&gt; <span class="kr">match</span> p <span class="kr">with</span> <span class="mi">1</span> =&gt; qinv_id _ <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">QInv_Univalence_type</span> := <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>@{i}),
      is_qinv (qinv_path A B).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk124"><span class="highlight"><span class="kn">Definition</span> <span class="nf">isequiv_qinv</span> {<span class="nv">A</span> <span class="nv">B</span>} {<span class="nv">f</span> : A -&gt; B}
    : is_qinv f -&gt; IsEquiv f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">is_qinv f -&gt; IsEquiv f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk125"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">is_qinv f -&gt; IsEquiv f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk126"><span class="highlight"><span class="nb">intros</span> [g [s r]].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; f (g x)) == idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; g (f x)) == idmap</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (isequiv_adjointify f g s r).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">equiv_qinv_path</span> (<span class="nv">qua</span>: QInv_Univalence_type) (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
    : (A = B) &lt;~&gt; qinv A B
    := Build_Equiv _ _ (qinv_path A B) (isequiv_qinv (qua A B)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">qinv_isequiv</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A -&gt; B) `{IsEquiv _ _ f}
    : qinv A B
    := (f ; (f^-<span class="mi">1</span> ; (eisretr f , eissect f))).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Context</span> `{qua : QInv_Univalence_type}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk127"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">qinv_univalence_isequiv_postcompose</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">w</span> : A -&gt; B}
          `{H0 : IsEquiv A B w} C : IsEquiv (<span class="kr">fun</span> (<span class="nv">g</span>:C-&gt;A) =&gt; w o g).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (<span class="kr">fun</span> <span class="nv">g</span> : C -&gt; A =&gt; w o g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk128"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (<span class="kr">fun</span> <span class="nv">g</span> : C -&gt; A =&gt; w o g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk129"><span class="highlight"><span class="nb">unfold</span> QInv_Univalence_type <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, is_qinv (qinv_path A B)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (<span class="kr">fun</span> (<span class="nv">g</span> : C -&gt; A) (<span class="nv">x</span> : C) =&gt; w (g x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12a"><span class="highlight"><span class="nb">pose</span> (w&#39; := qinv_isequiv w).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, is_qinv (qinv_path A B)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">w</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv w</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">w'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">qinv_isequiv w</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qinv A B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (<span class="kr">fun</span> (<span class="nv">g</span> : C -&gt; A) (<span class="nv">x</span> : C) =&gt; w (g x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">refine</span> (isequiv_adjointify
              (<span class="kr">fun</span> (<span class="nv">g</span>:C-&gt;A) =&gt; w o g)
              (<span class="kr">fun</span> (<span class="nv">g</span>:C-&gt;B) =&gt; w^-<span class="mi">1</span> o g)
              _
              _);
    <span class="nb">intros</span> g;
    <span class="kp">first</span> [ <span class="nb">change</span> ((<span class="kr">fun</span> <span class="nv">x</span> =&gt; w&#39;.<span class="mi">1</span> ( w&#39;.<span class="mi">2</span>.<span class="mi">1</span> (g x))) = g)
          | <span class="nb">change</span> ((<span class="kr">fun</span> <span class="nv">x</span> =&gt; w&#39;.<span class="mi">2</span>.<span class="mi">1</span> ( w&#39;.<span class="mi">1</span> (g x))) = g) ];
    <span class="nb">clearbody</span> w&#39;; <span class="nb">clear</span> H0 w;
    <span class="nb">rewrite</span> &lt;- (@eisretr _ _ (@qinv_path A B) (isequiv_qinv (qua A B)) w&#39;);
    <span class="nb">generalize</span> ((@equiv_inv _ _ (qinv_path A B) (isequiv_qinv (qua A B))) w&#39;);
    <span class="nb">intro</span> p; <span class="nb">clear</span> w&#39;; <span class="nb">destruct</span> p; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
  <span class="sd">(** Now the rest is basically copied from UnivalenceImpliesFunext, with name changes so as to use the current assumption of qinv-univalence rather than a global assumption of ordinary univalence. *)</span>

</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12b"><span class="highlight"><span class="kn">Instance</span> <span class="nf">isequiv_src_compose</span> <span class="nv">A</span> <span class="nv">B</span>
  : @IsEquiv (A -&gt; {xy : B * B &amp; fst xy = snd xy})
             (A -&gt; B)
             (<span class="kr">fun</span> <span class="nv">g</span> =&gt; (fst o pr1) o g).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv
  (<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
   fst o pr1 o g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv
  (<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
   fst o pr1 o g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12d"><span class="highlight">rapply @qinv_univalence_isequiv_postcompose.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv
  (<span class="kr">fun</span> <span class="nv">x</span> : {xy : B * B &amp; fst xy = snd xy} =&gt; fst x.<span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">refine</span> (isequiv_adjointify
              (fst o pr1) (<span class="kr">fun</span> <span class="nv">x</span> =&gt; ((x, x); idpath))
              (<span class="kr">fun</span> <span class="nv">_</span> =&gt; idpath)
              _);
      <span class="kr">let</span> <span class="nv">p</span> := <span class="kp">fresh</span> <span class="kr">in</span>
      <span class="nb">intros</span> [[? ?] p];
        <span class="nb">simpl</span> <span class="kr">in</span> p; <span class="nb">destruct</span> p;
        <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12e"><span class="highlight"><span class="kn">Instance</span> <span class="nf">isequiv_tgt_compose</span> <span class="nv">A</span> <span class="nv">B</span>
  : @IsEquiv (A -&gt; {xy : B * B &amp; fst xy = snd xy})
             (A -&gt; B)
             (<span class="kr">fun</span> <span class="nv">g</span> =&gt; (snd o pr1) o g).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv
  (<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
   snd o pr1 o g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv
  (<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
   snd o pr1 o g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk130"><span class="highlight">rapply @qinv_univalence_isequiv_postcompose.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv
  (<span class="kr">fun</span> <span class="nv">x</span> : {xy : B * B &amp; fst xy = snd xy} =&gt; snd x.<span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">refine</span> (isequiv_adjointify
              (snd o pr1) (<span class="kr">fun</span> <span class="nv">x</span> =&gt; ((x, x); idpath))
              (<span class="kr">fun</span> <span class="nv">_</span> =&gt; idpath)
              _);
      <span class="kr">let</span> <span class="nv">p</span> := <span class="kp">fresh</span> <span class="kr">in</span>
      <span class="nb">intros</span> [[? ?] p];
        <span class="nb">simpl</span> <span class="kr">in</span> p; <span class="nb">destruct</span> p;
        <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk131"><span class="highlight"><span class="kn">Theorem</span> <span class="nf">QInv_Univalence_implies_FunextNondep</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
  : <span class="kr">forall</span> <span class="nv">f</span> <span class="nv">g</span> : A -&gt; B, f == g -&gt; f = g.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">f</span> <span class="nv">g</span> : A -&gt; B, f == g -&gt; f = g</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk132"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">f</span> <span class="nv">g</span> : A -&gt; B, f == g -&gt; f = g</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk133"><span class="highlight"><span class="nb">intros</span> f g p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f == g</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f = g</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk134"><span class="highlight"><span class="nb">pose</span> (d := <span class="kr">fun</span> <span class="nv">x</span> : A =&gt; exist (<span class="kr">fun</span> <span class="nv">xy</span> =&gt; fst xy = snd xy) (f x, f x) (idpath (f x))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f == g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f = g</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk135"><span class="highlight"><span class="nb">pose</span> (e := <span class="kr">fun</span> <span class="nv">x</span> : A =&gt; exist (<span class="kr">fun</span> <span class="nv">xy</span> =&gt; fst xy = snd xy) (f x, g x) (p x)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f == g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, g x); p x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f = g</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk136"><span class="highlight"><span class="nb">change</span> f <span class="kr">with</span> ((snd o pr1) o d).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f == g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, g x); p x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">snd o pr1 o d = g</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk137"><span class="highlight"><span class="nb">change</span> g <span class="kr">with</span> ((snd o pr1) o e).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f == g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, g x); p x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">snd o pr1 o d = snd o pr1 o e</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk138"><span class="highlight">rapply (ap (<span class="kr">fun</span> <span class="nv">g</span> =&gt; snd o pr1 o g)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f == g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, g x); p x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">d = e</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk139"><span class="highlight"><span class="nb">pose</span> (<span class="kr">fun</span> <span class="nv">A</span> <span class="nv">B</span> <span class="nv">x</span> <span class="nv">y</span>=&gt; @equiv_inv _ _ _ (@isequiv_ap _ _ _ (@isequiv_src_compose A B) x y)) <span class="kr">as</span> H&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f == g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, g x); p x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
  (<span class="nv">x</span> <span class="nv">y</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy}) =&gt;
(ap
   (<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
    fst o pr1 o g))^-<span class="mi">1</span></span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
(<span class="nv">x</span> <span class="nv">y</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy}),
(<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
 fst o pr1 o g) x =
(<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
 fst o pr1 o g) y -&gt; x = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">d = e</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13a"><span class="highlight"><span class="nb">apply</span> H&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f == g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, g x); p x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
  (<span class="nv">x</span> <span class="nv">y</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy}) =&gt;
(ap
   (<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
    fst o pr1 o g))^-<span class="mi">1</span></span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
(<span class="nv">x</span> <span class="nv">y</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy}),
(<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
 fst o pr1 o g) x =
(<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
 fst o pr1 o g) y -&gt; x = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; fst (d x).<span class="mi">1</span>) =
(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; fst (e x).<span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">QInv_Univalence_implies_Funext_type</span> : Funext_type
    := NaiveNondepFunext_implies_Funext QInv_Univalence_implies_FunextNondep.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_4_6_i</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">EquivFunctorFunextType</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  <span class="c">(* We need a version of [equiv_functor_forall_id] that takes a [Funext_type] rather than a global axiom [Funext].  *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Context</span> (<span class="nv">fa</span> : Funext_type).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">ft_path_forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">P</span> : A -&gt; <span class="kt">Type</span>} (<span class="nv">f</span> <span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">x</span> : A, P x) :
  f == g -&gt; f = g
  :=
  @equiv_inv _ _ (@apD10 A P f g) (fa _ _ _ _).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13b"><span class="highlight"><span class="kn">Instance</span> <span class="nf">ft_isequiv_functor_forall</span>
        {<span class="nv">A</span> <span class="nv">B</span>:<span class="kt">Type</span>} `{P : A -&gt; <span class="kt">Type</span>} `{Q : B -&gt; <span class="kt">Type</span>}
          {f : B -&gt; A} {g : <span class="kr">forall</span> <span class="nv">b</span>:B, P (f b) -&gt; Q b}
        `{IsEquiv B A f} `{<span class="kr">forall</span> <span class="nv">b</span>, @IsEquiv (P (f b)) (Q b) (g b)}
    : IsEquiv (functor_forall f g) | <span class="mi">1000</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, P (f b) -&gt; Q b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, IsEquiv (g b)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (functor_forall f g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, P (f b) -&gt; Q b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, IsEquiv (g b)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsEquiv (functor_forall f g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13d"><span class="highlight"><span class="nb">simple refine</span> (isequiv_adjointify
                     (functor_forall f g)
                     (functor_forall
                        (f^-<span class="mi">1</span>)
                        (<span class="kr">fun</span> (<span class="nv">x</span>:A) (<span class="nv">y</span>:Q (f^-<span class="mi">1</span> x)) =&gt; eisretr f x # (g (f^-<span class="mi">1</span> x))^-<span class="mi">1</span> y
                     )) _ _);
      <span class="nb">intros</span> h.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, P (f b) -&gt; Q b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, IsEquiv (g b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, Q b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">functor_forall f g
  (functor_forall f^-<span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : Q (f^-<span class="mi">1</span> x)) =&gt;
      transport P (eisretr f x) ((g (f^-<span class="mi">1</span> x))^-<span class="mi">1</span> y)) h) =
h</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk13e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, P (f b) -&gt; Q b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, IsEquiv (g b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P a</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk13e"><hr></label><div class="goal-conclusion"><span class="highlight">functor_forall f^-<span class="mi">1</span>
  (<span class="kr">fun</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : Q (f^-<span class="mi">1</span> x)) =&gt;
   transport P (eisretr f x) ((g (f^-<span class="mi">1</span> x))^-<span class="mi">1</span> y))
  (functor_forall f g h) = h</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13f"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, P (f b) -&gt; Q b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, IsEquiv (g b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, Q b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">functor_forall f g
  (functor_forall f^-<span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : Q (f^-<span class="mi">1</span> x)) =&gt;
      transport P (eisretr f x) ((g (f^-<span class="mi">1</span> x))^-<span class="mi">1</span> y)) h) =
h</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kp">abstract</span> (
          <span class="nb">apply</span> ft_path_forall; <span class="nb">intros</span> b; <span class="nb">unfold</span> functor_forall;
          <span class="nb">rewrite</span> eisadj;
          <span class="nb">rewrite</span> &lt;- transport_compose;
          <span class="nb">rewrite</span> ap_transport;
          <span class="nb">rewrite</span> eisretr;
          <span class="nb">apply</span> apD
        ).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk140"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; <span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, P (f b) -&gt; Q b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : B, IsEquiv (g b)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">h</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, P a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">functor_forall f^-<span class="mi">1</span>
  (<span class="kr">fun</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : Q (f^-<span class="mi">1</span> x)) =&gt;
   transport P (eisretr f x) ((g (f^-<span class="mi">1</span> x))^-<span class="mi">1</span> y))
  (functor_forall f g h) = h</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kp">abstract</span> (
          <span class="nb">apply</span> ft_path_forall; <span class="nb">intros</span> a; <span class="nb">unfold</span> functor_forall;
          <span class="nb">rewrite</span> eissect;
          <span class="nb">apply</span> apD
        ).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">ft_equiv_functor_forall</span>
        {<span class="nv">A</span> <span class="nv">B</span>:<span class="kt">Type</span>} `{P : A -&gt; <span class="kt">Type</span>} `{Q : B -&gt; <span class="kt">Type</span>}
        (f : B -&gt; A) `{IsEquiv B A f}
        (g : <span class="kr">forall</span> <span class="nv">b</span>:B, P (f b) -&gt; Q b)
        `{<span class="kr">forall</span> <span class="nv">b</span>, @IsEquiv (P (f b)) (Q b) (g b)}
  : (<span class="kr">forall</span> <span class="nv">a</span>, P a) &lt;~&gt; (<span class="kr">forall</span> <span class="nv">b</span>, Q b)
    := Build_Equiv _ _ (functor_forall f g) _.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">ft_equiv_functor_forall_id</span>
        {<span class="nv">A</span>:<span class="kt">Type</span>} `{P : A -&gt; <span class="kt">Type</span>} `{Q : A -&gt; <span class="kt">Type</span>}
        (g : <span class="kr">forall</span> <span class="nv">a</span>, P a &lt;~&gt; Q a)
  : (<span class="kr">forall</span> <span class="nv">a</span>, P a) &lt;~&gt; (<span class="kr">forall</span> <span class="nv">a</span>, Q a)
    := ft_equiv_functor_forall (equiv_idmap A) g.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">EquivFunctorFunextType</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** Using the Kraus-Sattler space of loops rather than the version in the book, since it is simpler and avoids use of propositional truncation. *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk141"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_4_6_ii</span>
           (<span class="nv">qua1</span> <span class="nv">qua2</span> : QInv_Univalence_type)
  : ~ IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : { X : <span class="kt">Type</span> &amp; X = X }, A = A).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk142"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk143"><span class="highlight"><span class="nb">pose</span> (fa := @QInv_Univalence_implies_Funext_type qua2).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk144"><span class="highlight"><span class="nb">intros</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk145"><span class="highlight"><span class="nb">pose</span> (K := <span class="kr">forall</span> (<span class="nv">X</span>:<span class="kt">Type</span>) (<span class="nv">p</span>:X=X), { q : X=X &amp; p @ q = q @ p }).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk146"><span class="highlight"><span class="nb">assert</span> (e : K &lt;~&gt; <span class="kr">forall</span> <span class="nv">A</span> : { X : <span class="kt">Type</span> &amp; X = X }, A = A).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk147" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk147"><hr></label><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk148"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk149"><span class="highlight"><span class="nb">unfold</span> K.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
 {q : X = X &amp; p @ q = q @ p}) &lt;~&gt;
(<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk14a"><span class="highlight"><span class="nb">refine</span> (equiv_sig_ind _ oE _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
 {q : X = X &amp; p @ q = q @ p}) &lt;~&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : <span class="kt">Type</span>) (<span class="nv">y</span> : x = x), (x; y) = (x; y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk14b"><span class="highlight"><span class="nb">refine</span> (ft_equiv_functor_forall_id fa _); <span class="nb">intros</span> X.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">forall</span> <span class="nv">p</span> : X = X, {q : X = X &amp; p @ q = q @ p}) &lt;~&gt;
(<span class="kr">forall</span> <span class="nv">y</span> : X = X, (X; y) = (X; y))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk14c"><span class="highlight"><span class="nb">refine</span> (ft_equiv_functor_forall_id fa _); <span class="nb">intros</span> p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X = X</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{q : X = X &amp; p @ q = q @ p} &lt;~&gt; (X; p) = (X; p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk14d"><span class="highlight"><span class="nb">refine</span> (equiv_path_sigma _ _ _ oE _); <span class="nb">cbn</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X = X</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{q : X = X &amp; p @ q = q @ p} &lt;~&gt;
{p0 : X = X &amp;
transport (<span class="kr">fun</span> <span class="nv">X</span> : <span class="kt">Type</span> =&gt; X = X) p0 p = p}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk14e"><span class="highlight"><span class="nb">refine</span> (equiv_functor_sigma_id _); <span class="nb">intros</span> q.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X = X</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p @ q = q @ p &lt;~&gt;
transport (<span class="kr">fun</span> <span class="nv">X</span> : <span class="kt">Type</span> =&gt; X = X) q p = p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk14f"><span class="highlight"><span class="nb">refine</span> ((equiv_concat_l (transport_paths_lr q p)^ p)^-<span class="mi">1</span> oE _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X = X</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p @ q = q @ p &lt;~&gt; (q^ @ p) @ q = p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk150"><span class="highlight"><span class="nb">refine</span> ((equiv_concat_l (concat_p_pp _ _ _) _)^-<span class="mi">1</span> oE _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p, q</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">X = X</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p @ q = q @ p &lt;~&gt; q^ @ (p @ q) = p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> equiv_moveR_Vp.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk151"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk152"><span class="highlight"><span class="nb">assert</span> (HK := @istrunc_equiv_istrunc _ _ e^-<span class="mi">1</span> (-<span class="mi">1</span>)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk153"><span class="highlight"><span class="nb">assert</span> (u : <span class="kr">forall</span> (<span class="nv">X</span>:<span class="kt">Type</span>) (<span class="nv">p</span>:X=X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk154" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk154"><hr></label><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk155"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">intros</span> X p; <span class="nb">rewrite</span> concat_p1, concat_1p; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk156"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk157"><span class="highlight"><span class="nb">pose</span> (alpha := (<span class="kr">fun</span> <span class="nv">X</span> <span class="nv">p</span> =&gt; (idpath X ; u X p)) : K).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">alpha</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (<span class="mi">1</span>; u X p)) : K</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk158"><span class="highlight"><span class="nb">pose</span> (beta := (<span class="kr">fun</span> <span class="nv">X</span> <span class="nv">p</span> =&gt; (p ; <span class="mi">1</span>)) : K).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">alpha</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (<span class="mi">1</span>; u X p)) : K</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">beta</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (p; <span class="mi">1</span>)) : K</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk159"><span class="highlight"><span class="nb">pose</span> (isequiv_qinv (qua1 Bool Bool)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">alpha</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (<span class="mi">1</span>; u X p)) : K</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">beta</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (p; <span class="mi">1</span>)) : K</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">isequiv_qinv (qua1 Bool Bool)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (qinv_path Bool Bool)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15a"><span class="highlight"><span class="nb">assert</span> (r := pr1_path (apD10 (apD10 (path_ishprop alpha beta) Bool)
                     ((qinv_path Bool Bool)^-<span class="mi">1</span> (qinv_isequiv equiv_negb)))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">alpha</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (<span class="mi">1</span>; u X p)) : K</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">beta</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (p; <span class="mi">1</span>)) : K</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">isequiv_qinv (qua1 Bool Bool)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (qinv_path Bool Bool)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(alpha Bool
   ((qinv_path Bool Bool)^-<span class="mi">1</span>
      (qinv_isequiv equiv_negb))).<span class="mi">1</span> =
(beta Bool
   ((qinv_path Bool Bool)^-<span class="mi">1</span>
      (qinv_isequiv equiv_negb))).<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15b"><span class="highlight"><span class="nb">unfold</span> alpha, beta <span class="kr">in</span> r; <span class="nb">clear</span> alpha beta.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">isequiv_qinv (qua1 Bool Bool)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (qinv_path Bool Bool)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="mi">1</span>;
u Bool
  ((qinv_path Bool Bool)^-<span class="mi">1</span>
     (qinv_isequiv equiv_negb))).<span class="mi">1</span> =
((qinv_path Bool Bool)^-<span class="mi">1</span>
   (qinv_isequiv equiv_negb); <span class="mi">1</span>).<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15c"><span class="highlight"><span class="nb">apply</span> (ap (qinv_path Bool Bool)) <span class="kr">in</span> r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">isequiv_qinv (qua1 Bool Bool)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (qinv_path Bool Bool)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qinv_path Bool Bool
  (<span class="mi">1</span>;
  u Bool
    ((qinv_path Bool Bool)^-<span class="mi">1</span>
       (qinv_isequiv equiv_negb))).<span class="mi">1</span> =
qinv_path Bool Bool
  ((qinv_path Bool Bool)^-<span class="mi">1</span>
     (qinv_isequiv equiv_negb); <span class="mi">1</span>).<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15d"><span class="highlight"><span class="nb">rewrite</span> eisretr <span class="kr">in</span> r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">isequiv_qinv (qua1 Bool Bool)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (qinv_path Bool Bool)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qinv_path Bool Bool
  (<span class="mi">1</span>;
  u Bool
    ((qinv_path Bool Bool)^-<span class="mi">1</span>
       (qinv_isequiv equiv_negb))).<span class="mi">1</span> =
qinv_isequiv equiv_negb</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15e"><span class="highlight"><span class="nb">apply</span> pr1_path <span class="kr">in</span> r; <span class="nb">cbn</span> <span class="kr">in</span> r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fa</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">QInv_Univalence_implies_Funext_type</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">K</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HK</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">isequiv_qinv (qua1 Bool Bool)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (qinv_path Bool Bool)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">r</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">idmap = negb</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (true_ne_false (ap10 r true)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15f"><span class="highlight"><span class="kn">Definition</span> <span class="nf">allqinv_coherent</span> (<span class="nv">qua</span> : QInv_Univalence_type)
           (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : qinv A B)
  : (<span class="kr">fun</span> <span class="nv">x</span> =&gt; ap f.<span class="mi">2</span>.<span class="mi">1</span> (fst f.<span class="mi">2</span>.<span class="mi">2</span> x)) = (<span class="kr">fun</span> <span class="nv">x</span> =&gt; snd f.<span class="mi">2</span>.<span class="mi">2</span> (f.<span class="mi">2</span>.<span class="mi">1</span> x)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qinv A B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; ap (f.<span class="mi">2</span>).<span class="mi">1</span> (fst (f.<span class="mi">2</span>).<span class="mi">2</span> x)) =
(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; snd (f.<span class="mi">2</span>).<span class="mi">2</span> ((f.<span class="mi">2</span>).<span class="mi">1</span> x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk160"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">qinv A B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; ap (f.<span class="mi">2</span>).<span class="mi">1</span> (fst (f.<span class="mi">2</span>).<span class="mi">2</span> x)) =
(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; snd (f.<span class="mi">2</span>).<span class="mi">2</span> ((f.<span class="mi">2</span>).<span class="mi">1</span> x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk161"><span class="highlight"><span class="nb">revert</span> f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">f</span> : qinv A B,
(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; ap (f.<span class="mi">2</span>).<span class="mi">1</span> (fst (f.<span class="mi">2</span>).<span class="mi">2</span> x)) =
(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; snd (f.<span class="mi">2</span>).<span class="mi">2</span> ((f.<span class="mi">2</span>).<span class="mi">1</span> x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk162"><span class="highlight">equiv_intro (equiv_qinv_path qua A B) p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A = B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt;
 ap ((equiv_qinv_path qua A B p).<span class="mi">2</span>).<span class="mi">1</span>
   (fst ((equiv_qinv_path qua A B p).<span class="mi">2</span>).<span class="mi">2</span> x)) =
(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt;
 snd ((equiv_qinv_path qua A B p).<span class="mi">2</span>).<span class="mi">2</span>
   (((equiv_qinv_path qua A B p).<span class="mi">2</span>).<span class="mi">1</span> x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> p; <span class="nb">cbn</span>; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk163"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_4_6_iii</span> (<span class="nv">qua1</span> <span class="nv">qua2</span> : QInv_Univalence_type) : Empty.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk164"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk165"><span class="highlight"><span class="nb">apply</span> (Book_4_6_ii qua1 qua2).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk166"><span class="highlight"><span class="nb">refine</span> (istrunc_succ).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Contr (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk167"><span class="highlight"><span class="kr">exists</span> (<span class="nv">fun</span> <span class="nv">A</span> =&gt; <span class="mi">1</span>); <span class="nb">intros</span> u.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X} =&gt; <span class="mi">1</span>) = u</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk168"><span class="highlight"><span class="nb">set</span> (B := {X : <span class="kt">Type</span> &amp; X = X}) <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">qua1, qua2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">QInv_Univalence_type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">B</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">{X : <span class="kt">Type</span> &amp; X = X}</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">u</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : B, A = A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">fun</span> <span class="nv">A</span> : B =&gt; <span class="mi">1</span>) = u</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (allqinv_coherent qua2 B B (idmap ; (idmap ; (<span class="kr">fun</span> <span class="nv">A</span>:B =&gt; <span class="mi">1</span> , u)))).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:embedding-cancellable *)</span>
<span class="sd">(** Exercise 4.7 *)</span>



<span class="c">(* ================================================== ex:cancellable-from-bool *)</span>
<span class="sd">(** Exercise 4.8 *)</span>



<span class="c">(* ================================================== ex:funext-from-nondep *)</span>
<span class="sd">(** Exercise 4.9 *)</span>



<span class="c">(* ================================================== ex:ind-lst *)</span>
<span class="sd">(** Exercise 5.1 *)</span>



<span class="c">(* ================================================== ex:same-recurrence-not-defeq *)</span>
<span class="sd">(** Exercise 5.2 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_5_2</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  <span class="sd">(** Here is one example of functions which are propositionally equal but not judgmentally equal.  They satisfy the same reucrrence propositionally. *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">ez</span> : Bool := true.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">es</span> : nat -&gt; Bool -&gt; Bool := <span class="kr">fun</span> <span class="nv">_</span> =&gt; idmap.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_2_i</span> : nat -&gt; Bool := nat_ind (<span class="kr">fun</span> <span class="nv">_</span> =&gt; Bool) ez es.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_2_ii</span> : nat -&gt; Bool := <span class="kr">fun</span> <span class="nv">_</span> =&gt; true.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk169"><span class="highlight"><span class="kn">Fail</span> <span class="kn">Definition</span> <span class="nf">Book_5_2_not_defn_eq</span> : Book_5_2_i = Book_5_2_ii := idpath.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">The command has indeed failed <span class="kr">with</span> message:
In environment
ez := true : Bool
es := <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap : nat -&gt; Bool -&gt; Bool
The term <span class="s2">&quot;1&quot;</span> has type <span class="s2">&quot;Book_5_2_i = Book_5_2_i&quot;</span>
while it <span class="kr">is</span> expected to <span class="nb">have</span> type
 <span class="s2">&quot;Book_5_2_i = Book_5_2_ii&quot;</span> (cannot <span class="nb">unify</span> <span class="s2">&quot;Book_5_2_i&quot;</span>
<span class="kn">and</span> <span class="s2">&quot;Book_5_2_ii&quot;</span>).</span></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk16a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_5_2_i_prop_eq</span> : <span class="kr">forall</span> <span class="nv">n</span>, Book_5_2_i n = Book_5_2_ii n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ez</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">true</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">es</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; Bool -&gt; Bool</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Book_5_2_i n = Book_5_2_ii n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk16b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ez</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">true</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">es</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; Bool -&gt; Bool</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Book_5_2_i n = Book_5_2_ii n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">induction</span> n; <span class="nb">simpl</span>; <span class="nb">trivial</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_5_2</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_5_2&#39;</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Local Open Scope</span> nat_scope.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  <span class="sd">(** Here&#39;s another example where two functions are not (currently) definitionally equal, but satisfy the same reucrrence judgmentally.  This example is a bit less robust; it fails in CoqMT. *)</span>
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">ez</span> : nat := <span class="mi">1</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">es</span> : nat -&gt; nat -&gt; nat := <span class="kr">fun</span> <span class="nv">_</span> =&gt; S.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_i</span> : nat -&gt; nat := <span class="kr">fun</span> <span class="nv">n</span> =&gt; n + <span class="mi">1</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_ii</span> : nat -&gt; nat := <span class="kr">fun</span> <span class="nv">n</span> =&gt; <span class="mi">1</span> + n.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk16c"><span class="highlight"><span class="kn">Fail</span> <span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_not_defn_eq</span> : Book_5_2&#39;_i = Book_5_2&#39;_ii := idpath.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight">The command has indeed failed <span class="kr">with</span> message:
In environment
ez := <span class="mi">1</span> : nat
es := <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; S : nat -&gt; nat -&gt; nat
The term <span class="s2">&quot;1&quot;</span> has type <span class="s2">&quot;Book_5_2&#39;_i = Book_5_2&#39;_i&quot;</span>
while it <span class="kr">is</span> expected to <span class="nb">have</span> type
 <span class="s2">&quot;Book_5_2&#39;_i = Book_5_2&#39;_ii&quot;</span>
(cannot <span class="nb">unify</span> <span class="s2">&quot;Book_5_2&#39;_i&quot;</span> <span class="kn">and</span> <span class="s2">&quot;Book_5_2&#39;_ii&quot;</span>).</span></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_i_eq_ez</span> : Book_5_2&#39;_i <span class="mi">0</span> = ez := idpath.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_ii_eq_ez</span> : Book_5_2&#39;_ii <span class="mi">0</span> = ez := idpath.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_i_eq_es</span> <span class="nv">n</span> : Book_5_2&#39;_i (S n) = es n (Book_5_2&#39;_i n) := idpath.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_ii_eq_es</span> <span class="nv">n</span> : Book_5_2&#39;_ii (S n) = es n (Book_5_2&#39;_ii n) := idpath.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_5_2&#39;</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:one-function-two-recurrences *)</span>
<span class="sd">(** Exercise 5.3 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_5_3</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">ez</span> : Bool := true.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">es</span> : nat -&gt; Bool -&gt; Bool := <span class="kr">fun</span> <span class="nv">_</span> =&gt; idmap.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">ez&#39;</span> : Bool := true.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">es&#39;</span> : nat -&gt; Bool -&gt; Bool := <span class="kr">fun</span> <span class="nv">_</span> <span class="nv">_</span> =&gt; true.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_3</span> : nat -&gt; Bool := <span class="kr">fun</span> <span class="nv">_</span> =&gt; true.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_3_satisfies_ez</span> : Book_5_3 <span class="mi">0</span> = ez := idpath.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_3_satisfies_ez&#39;</span> : Book_5_3 <span class="mi">0</span> = ez&#39; := idpath.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_3_satisfies_es</span> <span class="nv">n</span> : Book_5_3 (S n) = es n (Book_5_3 n) := idpath.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_3_satisfies_es&#39;</span> <span class="nv">n</span> : Book_5_3 (S n) = es&#39; n (Book_5_3 n) := idpath.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_3_es_ne_es&#39;</span> : ~(es = es&#39;)
    := <span class="kr">fun</span> <span class="nv">H</span> =&gt; false_ne_true (ap10 (ap10 H <span class="mi">0</span>) false).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_5_3</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:bool *)</span>
<span class="sd">(** Exercise 5.4 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_5_4</span> := @HoTT.Types.Bool.equiv_bool_forall_prod.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:ind-nat-not-equiv *)</span>
<span class="sd">(** Exercise 5.5 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_5_5</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Let</span> <span class="nf">ind_nat</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>) := <span class="kr">fun</span> <span class="nv">x</span> =&gt; @nat_ind P (fst x) (snd x).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk16d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_5_5</span> `{fs : Funext} : ~<span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
                                     IsEquiv (@ind_nat P).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ (<span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>, IsEquiv (ind_nat P))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk16e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~ (<span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>, IsEquiv (ind_nat P))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk16f"><span class="highlight"><span class="nb">intro</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>, IsEquiv (ind_nat P)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk170"><span class="highlight"><span class="nb">specialize</span> (H (<span class="kr">fun</span> <span class="nv">_</span> =&gt; Bool)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk171"><span class="highlight"><span class="nb">pose proof</span> (eissect (@ind_nat (<span class="kr">fun</span> <span class="nv">_</span> =&gt; Bool)) (true, (<span class="kr">fun</span> <span class="nv">_</span> <span class="nv">_</span> =&gt; true))) <span class="kr">as</span> H1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk172"><span class="highlight"><span class="nb">pose proof</span> (eissect (@ind_nat (<span class="kr">fun</span> <span class="nv">_</span> =&gt; Bool)) (true, (<span class="kr">fun</span> <span class="nv">_</span> =&gt; idmap))) <span class="kr">as</span> H2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk173"><span class="highlight"><span class="nb">cut</span> (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)
         = (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) -&gt; Empty</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk174" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk174"><hr></label><div class="goal-conclusion"><span class="highlight">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk175"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) -&gt; Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk176"><span class="highlight"><span class="nb">intro</span> H&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk177"><span class="highlight"><span class="nb">apply</span> true_ne_false.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">true = false</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (ap10 (apD10 (ap snd (H1^ @ ap _ H&#39; @ H2)) <span class="mi">0</span>) false).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk178"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk179"><span class="highlight"><span class="nb">apply</span> path_forall.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) ==
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17a"><span class="highlight"><span class="nb">intro</span> n; <span class="nb">induction</span> n; <span class="nb">trivial</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) n =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) n.+<span class="mi">1</span> =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) n.+<span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17b"><span class="highlight"><span class="nb">unfold</span> ind_nat <span class="kr">in</span> *; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv
  (<span class="kr">fun</span> <span class="nv">x</span> : Bool * (nat -&gt; Bool -&gt; Bool) =&gt;
   nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (fst x) (snd x))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : Bool * (nat -&gt; Bool -&gt; Bool) =&gt;
 nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (fst x) (snd x))^-<span class="mi">1</span>
  (nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
     (<span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)) =
(true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : Bool * (nat -&gt; Bool -&gt; Bool) =&gt;
 nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (fst x) (snd x))^-<span class="mi">1</span>
  (nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
     (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)) =
(true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
  (<span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) n =
nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
  (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">true =
nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
  (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17c"><span class="highlight"><span class="nb">rewrite</span> &lt;- IHn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ind_nat</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight"><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">IsEquiv
  (<span class="kr">fun</span> <span class="nv">x</span> : Bool * (nat -&gt; Bool -&gt; Bool) =&gt;
   nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (fst x) (snd x))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : Bool * (nat -&gt; Bool -&gt; Bool) =&gt;
 nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (fst x) (snd x))^-<span class="mi">1</span>
  (nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
     (<span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)) =
(true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">fun</span> <span class="nv">x</span> : Bool * (nat -&gt; Bool -&gt; Bool) =&gt;
 nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (fst x) (snd x))^-<span class="mi">1</span>
  (nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
     (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)) =
(true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
  (<span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) n =
nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
  (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">true =
nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
  (<span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> n; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_5_5</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:no-dep-uniqueness-failure *)</span>
<span class="sd">(** Exercise 5.6 *)</span>



<span class="c">(* ================================================== ex:loop *)</span>
<span class="sd">(** Exercise 5.7 *)</span>



<span class="c">(* ================================================== ex:loop2 *)</span>
<span class="sd">(** Exercise 5.8 *)</span>



<span class="c">(* ================================================== ex:inductive-lawvere *)</span>
<span class="sd">(** Exercise 5.9 *)</span>



<span class="c">(* ================================================== ex:ilunit *)</span>
<span class="sd">(** Exercise 5.10 *)</span>



<span class="c">(* ================================================== ex:empty-inductive-type *)</span>
<span class="sd">(** Exercise 5.11 *)</span>



<span class="c">(* ================================================== ex:Wprop *)</span>
<span class="sd">(** Exercise 5.12 *)</span>



<span class="c">(* ================================================== ex:Wbounds *)</span>
<span class="sd">(** Exercise 5.13 *)</span>



<span class="c">(* ================================================== ex:Wdec *)</span>
<span class="sd">(** Exercise 5.14 *)</span>



<span class="c">(* ================================================== ex:Wbounds-loose *)</span>
<span class="sd">(** Exercise 5.15 *)</span>



<span class="c">(* ================================================== ex:Wimpred *)</span>
<span class="sd">(** Exercise 5.16 *)</span>



<span class="c">(* ================================================== ex:no-nullary-constructor *)</span>
<span class="sd">(** Exercise 5.17 *)</span>



<span class="c">(* ================================================== ex:torus *)</span>
<span class="sd">(** Exercise 6.1 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_6_1_i</span> := @HoTT.Cubical.DPath.dp_concat.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_6_1_ii</span> := @HoTT.Cubical.DPath.dp_apD_pp.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight"><span class="sd">(** We don&#39;t have the full induction principle for the torus *)</span>
<span class="c">(* Definition Book_6_1_iii := ? *)</span>

<span class="c">(* ================================================== ex:suspS1 *)</span>
<span class="sd">(** Exercise 6.2 *)</span>



<span class="c">(* ================================================== ex:torus-s1-times-s1 *)</span>
<span class="sd">(** Exercise 6.3 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_6_3</span> := @HoTT.Spaces.Torus.TorusEquivCircles.equiv_torus_prod_Circle.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

<span class="c">(* ================================================== ex:nspheres *)</span>
<span class="sd">(** Exercise 6.4 *)</span>



<span class="c">(* ================================================== ex:susp-spheres-equiv *)</span>
<span class="sd">(** Exercise 6.5 *)</span>



<span class="c">(* ================================================== ex:spheres-make-U-not-2-type *)</span>
<span class="sd">(** Exercise 6.6 *)</span>



<span class="c">(* ================================================== ex:monoid-eq-prop *)</span>
<span class="sd">(** Exercise 6.7 *)</span>



<span class="c">(* ================================================== ex:free-monoid *)</span>
<span class="sd">(** Exercise 6.8 *)</span>



<span class="c">(* ================================================== ex:unnatural-endomorphisms *)</span>
<span class="sd">(** Exercise 6.9 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_6_9</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Hypothesis</span> <span class="nv">LEM</span> : <span class="kr">forall</span> <span class="nv">A</span>, IsHProp A -&gt; A + ~A.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17d"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_6_9</span> {<span class="nv">ua</span> : Univalence} : <span class="kr">forall</span> <span class="nv">X</span>, X -&gt; X.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">X</span> : <span class="kt">Type</span>, X -&gt; X</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">X</span> : <span class="kt">Type</span>, X -&gt; X</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17f"><span class="highlight"><span class="nb">intro</span> X.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X -&gt; X</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk180"><span class="highlight"><span class="nb">pose proof</span> (@LEM (Contr { f : X &lt;~&gt; X &amp; ~(<span class="kr">forall</span> <span class="nv">x</span>, f x = x) }) _) <span class="kr">as</span> contrXEquiv.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">contrXEquiv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Contr
  {f : X &lt;~&gt; X &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)} +
~
Contr
  {f : X &lt;~&gt; X &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X -&gt; X</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk181"><span class="highlight"><span class="nb">destruct</span> contrXEquiv <span class="kr">as</span> [[f H]|H].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : X &lt;~&gt; X &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">y</span> : {f : X &lt;~&gt; X &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)},
f = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X -&gt; X</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk182" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ Contr {f : X &lt;~&gt; X &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)}</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk182"><hr></label><div class="goal-conclusion"><span class="highlight">X -&gt; X</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk183"><span class="highlight">- <span class="sd">(** In the case where we have exactly one autoequivalence which is not the identity, use it. *)</span></span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : X &lt;~&gt; X &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">y</span> : {f : X &lt;~&gt; X &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)},
f = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X -&gt; X</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (f.<span class="mi">1</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk184"><span class="highlight">- <span class="sd">(** In the other case, just use the identity. *)</span></span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ Contr {f : X &lt;~&gt; X &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X -&gt; X</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> idmap.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk185"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bool_map_equiv_not_idmap</span> (<span class="nv">f</span> : { f : Bool &lt;~&gt; Bool &amp; ~(<span class="kr">forall</span> <span class="nv">x</span>, f x = x) })
  : <span class="kr">forall</span> <span class="nv">b</span>, ~(f.<span class="mi">1</span> b = b).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : Bool, f.<span class="mi">1</span> b &lt;&gt; b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk186"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : Bool, f.<span class="mi">1</span> b &lt;&gt; b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk187"><span class="highlight"><span class="nb">intro</span> b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f.<span class="mi">1</span> b &lt;&gt; b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk188"><span class="highlight"><span class="nb">intro</span> H&#39;&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f.<span class="mi">1</span> b = b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk189"><span class="highlight"><span class="nb">apply</span> f.<span class="mi">2</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f.<span class="mi">1</span> b = b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : Bool, f.<span class="mi">1</span> x = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18a"><span class="highlight"><span class="nb">intro</span> b&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f.<span class="mi">1</span> b = b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f.<span class="mi">1</span> b&#39; = b&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18b"><span class="highlight"><span class="nb">pose proof</span> (eval_bool_isequiv f.<span class="mi">1</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H''</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f.<span class="mi">1</span> b = b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f.<span class="mi">1</span> false = negb (f.<span class="mi">1</span> true)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f.<span class="mi">1</span> b&#39; = b&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> b&#39;, b, (f.<span class="mi">1</span> true), (f.<span class="mi">1</span> false);
      <span class="nb">simpl</span> <span class="kr">in</span> *;
      <span class="kr">match goal with</span>
        | _ =&gt; <span class="bp">assumption</span>
        | _ =&gt; <span class="bp">reflexivity</span>
        | [ H : true = false |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> true_ne_false H <span class="kr">with</span> <span class="kr">end</span>)
        | [ H : false = true |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> false_ne_true H <span class="kr">with</span> <span class="kr">end</span>)
      <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_6_9_not_id</span> {<span class="nv">ua</span> : Univalence} `{fs : Funext} : Book_6_9 Bool = negb.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Book_6_9 Bool = negb</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Book_6_9 Bool = negb</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18e"><span class="highlight"><span class="nb">apply</span> path_forall; <span class="nb">intro</span> b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Book_6_9 Bool b = negb b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18f"><span class="highlight"><span class="nb">unfold</span> Book_6_9.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">match</span>
  LEM
    (Contr
       {f : Bool &lt;~&gt; Bool &amp;
       ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)})
    (ishprop_istrunc (-<span class="mi">2</span>)
       {f : Bool &lt;~&gt; Bool &amp;
       ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)})
<span class="kr">with</span>
| inl i =&gt;
    equiv_fun
      (center
         {f : Bool &lt;~&gt; Bool &amp;
         ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}).<span class="mi">1</span>
| inr _ =&gt; idmap
<span class="kr">end</span> b = negb b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk190"><span class="highlight"><span class="nb">destruct</span> (@LEM (Contr { f : Bool &lt;~&gt; Bool &amp; ~(<span class="kr">forall</span> <span class="nv">x</span>, f x = x) }) _) <span class="kr">as</span> [[f H&#39;]|H&#39;].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">y</span> : {f : Bool &lt;~&gt; Bool &amp;
    ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}, f = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f.<span class="mi">1</span> b = negb b</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk191" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk191"><hr></label><div class="goal-conclusion"><span class="highlight">b = negb b</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk192"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">y</span> : {f : Bool &lt;~&gt; Bool &amp;
    ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}, f = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f.<span class="mi">1</span> b = negb b</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk193"><span class="highlight"><span class="nb">pose proof</span> (bool_map_equiv_not_idmap f b).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span>
<span class="nv">y</span> : {f : Bool &lt;~&gt; Bool &amp;
    ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}, f = y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f.<span class="mi">1</span> b &lt;&gt; b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f.<span class="mi">1</span> b = negb b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> (f.<span class="mi">1</span> b), b;
      <span class="kr">match goal with</span>
        | _ =&gt; <span class="bp">assumption</span>
        | _ =&gt; <span class="bp">reflexivity</span>
        | [ H : ~(_ = _) |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> H idpath <span class="kr">with</span> <span class="kr">end</span>)
        | [ H : true = false |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> true_ne_false H <span class="kr">with</span> <span class="kr">end</span>)
        | [ H : false = true |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> false_ne_true H <span class="kr">with</span> <span class="kr">end</span>)
      <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk194"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">b = negb b</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk195"><span class="highlight"><span class="nb">refine</span> (<span class="kr">match</span> H&#39; _ <span class="kr">with</span> <span class="kr">end</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Contr
  {f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk196"><span class="highlight"><span class="nb">eexists</span> (exist (<span class="kr">fun</span> <span class="nv">f</span> : Bool &lt;~&gt; Bool =&gt;
                         ~(<span class="kr">forall</span> <span class="nv">x</span>, f x = x))
                      (Build_Equiv _ _ negb _)
                      (<span class="kr">fun</span> <span class="nv">H</span> =&gt; false_ne_true (H true)));
        <span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span>
<span class="nv">y</span> : {f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)},
({|
   equiv_fun := negb; equiv_isequiv := isequiv_negb
 |};
<span class="kr">fun</span> <span class="nv">H</span> : <span class="kr">forall</span> <span class="nv">x</span> : Bool, negb x = x =&gt;
false_ne_true (H true)) = y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk197"><span class="highlight"><span class="nb">intro</span> f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">({|
   equiv_fun := negb; equiv_isequiv := isequiv_negb
 |};
<span class="kr">fun</span> <span class="nv">H</span> : <span class="kr">forall</span> <span class="nv">x</span> : Bool, negb x = x =&gt;
false_ne_true (H true)) = f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk198"><span class="highlight"><span class="nb">apply</span> path_sigma_uncurried; <span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{p
: {|
    equiv_fun := negb; equiv_isequiv := isequiv_negb
  |} = f.<span class="mi">1</span> &amp;
transport
  (<span class="kr">fun</span> <span class="nv">f</span> : Bool &lt;~&gt; Bool =&gt;
   ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)) p
  (<span class="kr">fun</span> <span class="nv">H</span> : <span class="kr">forall</span> <span class="nv">x</span> : Bool, negb x = x =&gt;
   false_ne_true (H true)) = f.<span class="mi">2</span>}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk199"><span class="highlight"><span class="nb">refine</span> ((<span class="kr">fun</span> <span class="nv">H&#39;&#39;</span> =&gt;
                 (equiv_path_equiv _ _ H&#39;&#39;;
                  path_ishprop _ _))
                _);
        <span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">negb = f.<span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19a"><span class="highlight"><span class="nb">apply</span> path_forall; <span class="nb">intro</span> b&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">negb b&#39; = f.<span class="mi">1</span> b&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19b"><span class="highlight"><span class="nb">pose proof</span> (bool_map_equiv_not_idmap f b&#39;).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ua</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Univalence</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f.<span class="mi">1</span> b&#39; &lt;&gt; b&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">negb b&#39; = f.<span class="mi">1</span> b&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> (f.<span class="mi">1</span> b&#39;), b&#39;;
      <span class="kr">match goal with</span>
        | _ =&gt; <span class="bp">assumption</span>
        | _ =&gt; <span class="bp">reflexivity</span>
        | [ H : ~(_ = _) |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> H idpath <span class="kr">with</span> <span class="kr">end</span>)
        | [ H : true = false |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> true_ne_false H <span class="kr">with</span> <span class="kr">end</span>)
        | [ H : false = true |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> false_ne_true H <span class="kr">with</span> <span class="kr">end</span>)
      <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(** Simpler solution not using univalence **)</span>

</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">AllExistsOther</span>(<span class="nv">X</span> : <span class="kt">Type</span>) := <span class="kr">forall</span> <span class="nv">x</span>:X, { y:X | y &lt;&gt; x }.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">centerAllExOthBool</span> : AllExistsOther Bool :=
    <span class="kr">fun</span> (<span class="nv">b</span>:Bool) =&gt; (negb b ; not_fixed_negb b).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">centralAllExOthBool</span> `{Funext} (f: AllExistsOther Bool) : centerAllExOthBool = f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">AllExistsOther Bool</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">centerAllExOthBool = f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">AllExistsOther Bool</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">centerAllExOthBool = f</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19e"><span class="highlight"><span class="nb">apply</span> path_forall.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">AllExistsOther Bool</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">centerAllExOthBool == f</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19f"><span class="highlight"><span class="nb">intro</span> b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">AllExistsOther Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">centerAllExOthBool b = f b</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a0"><span class="highlight"><span class="nb">pose proof</span> (inverse (negb_ne (f b).<span class="mi">2</span>)) <span class="kr">as</span> fst.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">AllExistsOther Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fst</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">negb b = (f b).<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">centerAllExOthBool b = f b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a1"><span class="highlight"><span class="nb">unfold</span> centerAllExOthBool.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">AllExistsOther Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fst</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">negb b = (f b).<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(negb b; not_fixed_negb b) = f b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a2"><span class="highlight"><span class="nb">apply</span> (@path_sigma _ _ (negb b; not_fixed_negb b) (f b) fst); <span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">AllExistsOther Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fst</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">negb b = (f b).<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">transport (<span class="kr">fun</span> <span class="nv">y</span> : Bool =&gt; y &lt;&gt; b) fst
  (not_fixed_negb b) = (f b).<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a3"><span class="highlight"><span class="nb">apply</span> equiv_hprop_allpath.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">AllExistsOther Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fst</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">negb b = (f b).<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHProp ((f b).<span class="mi">1</span> &lt;&gt; b)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> istrunc_forall.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">contrAllExOthBool</span> `{Funext} : Contr (AllExistsOther Bool) :=
  (Build_Contr _ centerAllExOthBool centralAllExOthBool).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a4"><span class="highlight"><span class="kn">Definition</span> <span class="nf">solution_6_9</span> `{Funext} : <span class="kr">forall</span> <span class="nv">X</span>, X -&gt; X.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">X</span> : <span class="kt">Type</span>, X -&gt; X</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">X</span> : <span class="kt">Type</span>, X -&gt; X</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a6"><span class="highlight"><span class="nb">intro</span> X.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X -&gt; X</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a7"><span class="highlight"><span class="nb">elim</span> (@LEM (Contr (AllExistsOther X)) _); <span class="nb">intro</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Contr (AllExistsOther X)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X -&gt; X</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1a8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ Contr (AllExistsOther X)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk1a8"><hr></label><div class="goal-conclusion"><span class="highlight">X -&gt; X</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a9"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Contr (AllExistsOther X)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X -&gt; X</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span>:X =&gt; (center (AllExistsOther X) x).<span class="mi">1</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1aa"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ Contr (AllExistsOther X)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">X -&gt; X</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span>:X =&gt; x).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ab"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">not_id_on_Bool</span> `{Funext} : solution_6_9 Bool &lt;&gt; idmap.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">solution_6_9 Bool &lt;&gt; idmap</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ac"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">solution_6_9 Bool &lt;&gt; idmap</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ad"><span class="highlight"><span class="nb">intro</span> Bad.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ae"><span class="highlight"><span class="nb">pose proof</span> ((happly Bad) true) <span class="kr">as</span> Ugly.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1af"><span class="highlight"><span class="nb">assert</span> ((solution_6_9 Bool true) = false) <span class="kr">as</span> Good.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">solution_6_9 Bool true = false</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1b0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Good</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = false</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk1b0"><hr></label><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b1"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">solution_6_9 Bool true = false</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b2"><span class="highlight"><span class="nb">unfold</span> solution_6_9.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sum_rect
  (<span class="kr">fun</span>
     <span class="nv">_</span> : Contr (AllExistsOther Bool) +
         ~ Contr (AllExistsOther Bool) =&gt; Bool -&gt; Bool)
  (<span class="kr">fun</span> (<span class="nv">a</span> : Contr (AllExistsOther Bool)) (<span class="nv">x</span> : Bool) =&gt;
   (center (AllExistsOther Bool) x).<span class="mi">1</span>)
  (<span class="kr">fun</span> <span class="nv">_</span> : ~ Contr (AllExistsOther Bool) =&gt; idmap)
  (LEM (Contr (AllExistsOther Bool))
     (ishprop_istrunc (-<span class="mi">2</span>) (AllExistsOther Bool)))
  true = false</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b3"><span class="highlight"><span class="nb">destruct</span> (LEM (Contr (AllExistsOther Bool)) _) <span class="kr">as</span> [[f C]|C];<span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">AllExistsOther Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : AllExistsOther Bool, f = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(f true).<span class="mi">1</span> = false</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1b4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ Contr (AllExistsOther Bool)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk1b4"><hr></label><div class="goal-conclusion"><span class="highlight">true = false</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b5"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">AllExistsOther Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : AllExistsOther Bool, f = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(f true).<span class="mi">1</span> = false</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b6"><span class="highlight"><span class="nb">elim</span> (centralAllExOthBool f).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">AllExistsOther Bool</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">y</span> : AllExistsOther Bool, f = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(centerAllExOthBool true).<span class="mi">1</span> = false</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b7"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">C</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ Contr (AllExistsOther Bool)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">true = false</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">elim</span> (C contrAllExOthBool).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b8"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Good</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = false</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Empty</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b9"><span class="highlight"><span class="nb">apply</span> false_ne_true.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Good</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = false</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">false = true</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ba"><span class="highlight"><span class="nb">rewrite</span> (inverse Good).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">LEM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Funext</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Bad</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool = idmap</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ugly</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = idmap true</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Good</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">solution_6_9 Bool true = false</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">solution_6_9 Bool true = true</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_6_9</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:funext-from-interval *)</span>
<span class="sd">(** Exercise 6.10 *)</span>



<span class="c">(* ================================================== ex:susp-lump *)</span>
<span class="sd">(** Exercise 6.11 *)</span>



<span class="c">(* ================================================== ex:alt-integers *)</span>
<span class="sd">(** Exercise 6.12 *)</span>



<span class="c">(* ================================================== ex:trunc-bool-interval *)</span>
<span class="sd">(** Exercise 6.13 *)</span>



<span class="c">(* ================================================== ex:all-types-sets *)</span>
<span class="sd">(** Exercise 7.1 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Book_7_1</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1bb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_7_1_part_i</span> (<span class="nv">H</span> : <span class="kr">forall</span> <span class="nv">A</span>, merely A -&gt; A) <span class="nv">A</span> : IsHSet A.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1bc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">IsHSet A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1bd"><span class="highlight"><span class="nb">apply</span> (@HoTT.HSet.ishset_hrel_subpaths
             A (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> =&gt; merely (x = y)));
    <span class="kp">try</span> <span class="nb">typeclasses eauto</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Reflexive (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> : A =&gt; merely (x = y))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1be" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="hottbookexercises-v-chk1be"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : A, merely (x = y) -&gt; x = y</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1bf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1bf"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Reflexive (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> : A =&gt; merely (x = y))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c0"><span class="highlight"><span class="nb">intros</span> ?.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">merely (x = x)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c1"><span class="highlight"><span class="nb">apply</span> tr.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c2"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : A, merely (x = y) -&gt; x = y</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c3"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">merely (x = y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = y</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c4"><span class="highlight"><span class="nb">apply</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">merely (x = y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">merely (x = y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Book_7_1_part_ii</span> (<span class="nv">H</span> : <span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> (<span class="nv">f</span> : A -&gt; B),
                                (<span class="kr">forall</span> <span class="nv">b</span>, merely (hfiber f b))
                                -&gt; <span class="kr">forall</span> <span class="nv">b</span>, hfiber f b)
  : <span class="kr">forall</span> <span class="nv">A</span>, IsHSet A.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHSet A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHSet A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c7"><span class="highlight"><span class="nb">apply</span> Book_7_1_part_i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c8"><span class="highlight"><span class="nb">intros</span> A a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">merely A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">A</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c9"><span class="highlight"><span class="nb">apply</span> (<span class="kr">fun</span> <span class="nv">H&#39;</span> =&gt; (@H A (merely A) tr H&#39; a).<span class="mi">1</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">merely A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : merely A, merely (hfiber tr b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ca" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ca"><span class="highlight"><span class="nb">clear</span> a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">b</span> : merely A, merely (hfiber tr b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1cb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1cb"><span class="highlight"><span class="nb">apply</span> Trunc_ind; <span class="kp">try</span> <span class="bp">exact</span> _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, merely (hfiber tr (tr a))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1cc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1cc"><span class="highlight"><span class="nb">intro</span> x; <span class="nb">compute</span>; <span class="nb">apply</span> tr.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{x0 : A &amp; tr x0 = tr x}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kr">exists</span> <span class="nv">x</span>; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Book_7_1</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:s2-colim-unit *)</span>
<span class="sd">(** Exercise 7.2 *)</span>



<span class="c">(* ================================================== ex:ntypes-closed-under-wtypes *)</span>
<span class="sd">(** Exercise 7.3 *)</span>



<span class="c">(* ================================================== ex:connected-pointed-all-section-retraction *)</span>
<span class="sd">(** Exercise 7.4 *)</span>



<span class="c">(* ================================================== ex:ntype-from-nconn-const *)</span>
<span class="sd">(** Exercise 7.5 *)</span>



<span class="c">(* ================================================== ex:connectivity-inductively *)</span>
<span class="sd">(** Exercise 7.6 *)</span>



<span class="c">(* ================================================== ex:lemnm *)</span>
<span class="sd">(** Exercise 7.7 *)</span>



<span class="c">(* ================================================== ex:acnm *)</span>
<span class="sd">(** Exercise 7.8 *)</span>



<span class="c">(* ================================================== ex:acnm-surjset *)</span>
<span class="sd">(** Exercise 7.9 *)</span>

<span class="sd">(** Solution for the case (oo,-1). *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_7_9_oo_neg1</span> `{Univalence} (AC_oo_neg1 : <span class="kr">forall</span> <span class="nv">X</span> : HSet, HasChoice X) (A : <span class="kt">Type</span>)
  : merely (<span class="kr">exists</span> <span class="nv">X</span> : HSet, <span class="kr">exists</span> <span class="nv">p</span> : X -&gt; A, IsSurjection p)
  := @HoTT.Projective.projective_cover_AC AC_oo_neg1 _ A.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:acconn *)</span>
<span class="sd">(** Exercise 7.10 *)</span>



<span class="c">(* ================================================== ex:n-truncation-not-left-exact *)</span>
<span class="sd">(** Exercise 7.11 *)</span>



<span class="c">(* ================================================== ex:double-negation-modality *)</span>
<span class="sd">(** Exercise 7.12 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_7_12</span> := @HoTT.Modalities.Notnot.NotNot.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:prop-modalities *)</span>
<span class="sd">(** Exercise 7.13 *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_7_13_part_i</span> := @HoTT.Modalities.Open.Op.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">Book_7_13_part_ii</span> := @HoTT.Modalities.Closed.Cl.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* ================================================== ex:f-local-type *)</span>
<span class="sd">(** Exercise 7.14 *)</span>



<span class="c">(* ================================================== ex:trunc-spokes-no-hub *)</span>
<span class="sd">(** Exercise 7.15 *)</span>



<span class="c">(* ================================================== ex:s2-colim-unit-2 *)</span>
<span class="sd">(** Exercise 7.16 *)</span>



<span class="c">(* ================================================== ex:fiber-map-not-conn *)</span>
<span class="sd">(** Exercise 7.17 *)</span>



<span class="c">(* ================================================== ex:is-conn-trunc-functor *)</span>
<span class="sd">(** Exercise 7.18 *)</span>



<span class="c">(* ================================================== ex:categorical-connectedness *)</span>
<span class="sd">(** Exercise 7.19 *)</span>



<span class="c">(* ================================================== ex:homotopy-groups-resp-prod *)</span>
<span class="sd">(** Exercise 8.1 *)</span>



<span class="c">(* ================================================== ex:decidable-equality-susp *)</span>
<span class="sd">(** Exercise 8.2 *)</span>



<span class="c">(* ================================================== ex:contr-infinity-sphere-colim *)</span>
<span class="sd">(** Exercise 8.3 *)</span>



<span class="c">(* ================================================== ex:contr-infinity-sphere-susp *)</span>
<span class="sd">(** Exercise 8.4 *)</span>



<span class="c">(* ================================================== ex:unique-fiber *)</span>
<span class="sd">(** Exercise 8.5 *)</span>



<span class="c">(* ================================================== ex:ap-path-inversion *)</span>
<span class="sd">(** Exercise 8.6 *)</span>



<span class="c">(* ================================================== ex:pointed-equivalences *)</span>
<span class="sd">(** Exercise 8.7 *)</span>



<span class="c">(* ================================================== ex:HopfJr *)</span>
<span class="sd">(** Exercise 8.8 *)</span>



<span class="c">(* ================================================== ex:SuperHopf *)</span>
<span class="sd">(** Exercise 8.9 *)</span>



<span class="c">(* ================================================== ex:vksusppt *)</span>
<span class="sd">(** Exercise 8.10 *)</span>



<span class="c">(* ================================================== ex:vksuspnopt *)</span>
<span class="sd">(** Exercise 8.11 *)</span>



<span class="c">(* ================================================== ex:slice-precategory *)</span>
<span class="sd">(** Exercise 9.1 *)</span>



<span class="c">(* ================================================== ex:set-slice-over-equiv-functor-category *)</span>
<span class="sd">(** Exercise 9.2 *)</span>



<span class="c">(* ================================================== ex:functor-equiv-right-adjoint *)</span>
<span class="sd">(** Exercise 9.3 *)</span>



<span class="c">(* ================================================== ct:pre2cat *)</span>
<span class="sd">(** Exercise 9.4 *)</span>



<span class="c">(* ================================================== ct:2cat *)</span>
<span class="sd">(** Exercise 9.5 *)</span>



<span class="c">(* ================================================== ct:groupoids *)</span>
<span class="sd">(** Exercise 9.6 *)</span>



<span class="c">(* ================================================== ex:2strict-cat *)</span>
<span class="sd">(** Exercise 9.7 *)</span>



<span class="c">(* ================================================== ex:pre2dagger-cat *)</span>
<span class="sd">(** Exercise 9.8 *)</span>



<span class="c">(* ================================================== ct:ex:hocat *)</span>
<span class="sd">(** Exercise 9.9 *)</span>



<span class="c">(* ================================================== ex:dagger-rezk *)</span>
<span class="sd">(** Exercise 9.10 *)</span>



<span class="c">(* ================================================== ex:rezk-vankampen *)</span>
<span class="sd">(** Exercise 9.11 *)</span>



<span class="c">(* ================================================== ex:stack *)</span>
<span class="sd">(** Exercise 9.12 *)</span>



<span class="c">(* ================================================== ex:utype-ct *)</span>
<span class="sd">(** Exercise 10.1 *)</span>



<span class="c">(* ================================================== ex:surjections-have-sections-impl-ac *)</span>
<span class="sd">(** Exercise 10.2 *)</span>



<span class="c">(* ================================================== ex:well-pointed *)</span>
<span class="sd">(** Exercise 10.3 *)</span>



<span class="c">(* ================================================== ex:add-ordinals *)</span>
<span class="sd">(** Exercise 10.4 *)</span>



<span class="c">(* ================================================== ex:multiply-ordinals *)</span>
<span class="sd">(** Exercise 10.5 *)</span>



<span class="c">(* ================================================== ex:algebraic-ordinals *)</span>
<span class="sd">(** Exercise 10.6 *)</span>



<span class="c">(* ================================================== ex:prop-ord *)</span>
<span class="sd">(** Exercise 10.7 *)</span>



<span class="c">(* ================================================== ex:ninf-ord *)</span>
<span class="sd">(** Exercise 10.8 *)</span>



<span class="c">(* ================================================== ex:well-founded-extensional-simulation *)</span>
<span class="sd">(** Exercise 10.9 *)</span>



<span class="c">(* ================================================== ex:choice-function *)</span>
<span class="sd">(** Exercise 10.10 *)</span>



<span class="c">(* ================================================== ex:cumhierhit *)</span>
<span class="sd">(** Exercise 10.11 *)</span>



<span class="c">(* ================================================== ex:strong-collection *)</span>
<span class="sd">(** Exercise 10.12 *)</span>



<span class="c">(* ================================================== ex:choice-cumulative-hierarchy-choice *)</span>
<span class="sd">(** Exercise 10.13 *)</span>



<span class="c">(* ================================================== ex:plump-ordinals *)</span>
<span class="sd">(** Exercise 10.14 *)</span>



<span class="c">(* ================================================== ex:not-plump *)</span>
<span class="sd">(** Exercise 10.15 *)</span>



<span class="c">(* ================================================== ex:plump-successor *)</span>
<span class="sd">(** Exercise 10.16 *)</span>



<span class="c">(* ================================================== ex:ZF-algebras *)</span>
<span class="sd">(** Exercise 10.17 *)</span>



<span class="c">(* ================================================== ex:monos-are-split-monos-iff-LEM-holds *)</span>
<span class="sd">(** Exercise 10.18 *)</span>



<span class="c">(* ================================================== ex:alt-dedekind-reals *)</span>
<span class="sd">(** Exercise 11.1 *)</span>



<span class="c">(* ================================================== ex:RD-extended-reals *)</span>
<span class="sd">(** Exercise 11.2 *)</span>



<span class="c">(* ================================================== ex:RD-lower-cuts *)</span>
<span class="sd">(** Exercise 11.3 *)</span>



<span class="c">(* ================================================== ex:RD-interval-arithmetic *)</span>
<span class="sd">(** Exercise 11.4 *)</span>



<span class="c">(* ================================================== ex:RD-lt-vs-le *)</span>
<span class="sd">(** Exercise 11.5 *)</span>



<span class="c">(* ================================================== ex:reals-non-constant-into-Z *)</span>
<span class="sd">(** Exercise 11.6 *)</span>



<span class="c">(* ================================================== ex:traditional-archimedean *)</span>
<span class="sd">(** Exercise 11.7 *)</span>



<span class="c">(* ================================================== RC-Lipschitz-on-interval *)</span>
<span class="sd">(** Exercise 11.8 *)</span>



<span class="c">(* ================================================== ex:metric-completion *)</span>
<span class="sd">(** Exercise 11.9 *)</span>



<span class="c">(* ================================================== ex:reals-apart-neq-MP *)</span>
<span class="sd">(** Exercise 11.10 *)</span>



<span class="c">(* ================================================== ex:reals-apart-zero-divisors *)</span>
<span class="sd">(** Exercise 11.11 *)</span>



<span class="c">(* ================================================== ex:finite-cover-lebesgue-number *)</span>
<span class="sd">(** Exercise 11.12 *)</span>



<span class="c">(* ================================================== ex:mean-value-theorem *)</span>
<span class="sd">(** Exercise 11.13 *)</span>



<span class="c">(* ================================================== ex:knuth-surreal-check *)</span>
<span class="sd">(** Exercise 11.14 *)</span>



<span class="c">(* ================================================== ex:reals-into-surreals *)</span>
<span class="sd">(** Exercise 11.15 *)</span>



<span class="c">(* ================================================== ex:ord-into-surreals *)</span>
<span class="sd">(** Exercise 11.16 *)</span>



<span class="c">(* ================================================== ex:hiit-plump *)</span>
<span class="sd">(** Exercise 11.17 *)</span>



<span class="c">(* ================================================== ex:pseudo-ordinals *)</span>
<span class="sd">(** Exercise 11.18 *)</span>



<span class="c">(* ================================================== ex:double-No-recursion *)</span>
<span class="sd">(** Exercise 11.19 *)</span></span></span></pre>
</div>
</div></body>
</html>
